import streamlit as st

def show_user_guide_page(get_text):
    """사용자 가이드 페이지를 표시합니다."""
    
    st.header("📖 Ver06 통합 관리 시스템 사용자 가이드")
    
    # 가이드 섹션 선택
    guide_sections = [
        "시작하기",
        "직원 관리",
        "고객 관리", 
        "제품 관리",
        "공급업체 관리",
        "견적/영업 관리",
        "비즈니스 프로세스",
        "승인 관리",
        "환율 관리",
        "PDF 디자인",
        "자주 묻는 질문"
    ]
    
    selected_section = st.sidebar.selectbox("가이드 섹션", guide_sections)
    
    if selected_section == "시작하기":
        st.subheader("🚀 시작하기")
        
        st.markdown("""
        ### Ver06 통합 관리 시스템에 오신 것을 환영합니다!
        
        이 시스템은 기업의 다양한 업무를 통합적으로 관리할 수 있는 ERP 시스템입니다.
        
        #### 주요 기능
        - **직원 관리**: 직원 정보, 휴가, 개인 상태 관리
        - **고객 관리**: 고객사 정보 및 관계 관리
        - **제품 관리**: 제품 정보, 가격, 재고 관리
        - **공급업체 관리**: 공급업체 정보 및 평가 관리
        - **견적/영업 관리**: 견적서 작성, PDF 생성, 영업 관리
        - **비즈니스 프로세스**: 견적-발주-재고-배송-인보이스 워크플로우
        - **승인 관리**: 각종 승인 요청 및 처리
        - **환율 관리**: 실시간 환율 정보 및 통화 변환
        - **PDF 디자인**: 커스텀 PDF 템플릿 관리
        
        #### 로그인
        1. **직원 로그인**: 사번과 비밀번호로 로그인 (초기 비밀번호: 1111)
        2. **마스터 로그인**: 관리자 전용 로그인
        
        #### 권한 관리
        - 마스터: 모든 기능 접근 가능
        - 직원: 부여된 권한에 따라 기능 접근
        """)
        
        st.info("💡 **팁**: 시스템을 처음 사용하는 경우 마스터 계정으로 로그인하여 직원 등록부터 시작하세요.")
    
    elif selected_section == "직원 관리":
        st.subheader("👥 직원 관리")
        
        st.markdown("""
        ### 직원 관리 기능
        
        #### 1. 직원 목록
        - 전체 직원 정보 조회
        - 상태별 필터링 (재직/퇴사)
        - 지역별 필터링
        - 이름, 사번, 영문이름으로 검색
        
        #### 2. 직원 등록
        **필수 정보**:
        - 이름, 성별, 생년월일
        - 국적, 거주국가, 지역
        - 입사일, 직급
        
        **선택 정보**:
        - 영문이름, 급여, 연락처, 이메일
        - 운전면허 유무
        
        #### 3. 직원 수정
        - 기존 직원 정보 수정
        - 상태 변경 (재직/퇴사)
        - 삭제 권한이 있는 경우 직원 삭제 가능
        
        #### 4. 권한 관리 (마스터만)
        각 직원별로 다음 권한 설정 가능:
        - 직원 관리 접근
        - 제품 관리 접근
        - 고객 관리 접근
        - 영업 관리 접근
        - 환율 관리 접근
        - 데이터 삭제 권한
        
        #### 5. 대량 등록
        - CSV 파일로 여러 직원 한번에 등록
        - 템플릿 다운로드 제공
        
        #### 6. 개인 상태 관리 (직원 본인만)
        - 개인 상태 변경 신청 (재직/휴가/출장/병가/교육)
        - 상태 변경 이력 조회
        
        #### 7. 휴가 관리
        - 휴가 신청 (연차/병가/개인사유/경조사)
        - 휴가 승인/거부 (마스터)
        - 휴가 사용 현황 조회
        """)
        
        st.warning("⚠️ **주의**: 직원 정보 수정 및 삭제는 권한이 있는 사용자만 가능합니다.")
    
    elif selected_section == "고객 관리":
        st.subheader("🏢 고객 관리")
        
        st.markdown("""
        ### 고객 관리 기능
        
        #### 1. 고객 목록
        - 전체 고객사 정보 조회
        - 국가별, 사업유형별 필터링
        - 회사명, 담당자, 고객ID로 검색
        
        #### 2. 고객 등록
        **필수 정보**:
        - 회사명, 국가
        
        **선택 정보**:
        - 담당자명, 연락처, 이메일
        - 주소, 도시, 사업유형
        - 사업자번호, 비고
        
        #### 3. 고객 수정
        - 기존 고객 정보 수정
        - 상태 변경 (활성/비활성)
        - 삭제 권한이 있는 경우 고객 삭제 가능
        
        #### 4. 고객 통계
        - 국가별 고객 분포
        - 사업유형별 분포
        - 활성 고객 현황
        
        #### 5. 대량 작업
        - CSV 파일로 대량 등록
        - 전체 고객 데이터 다운로드
        
        #### 지원 국가
        - 한국, 중국, 태국, 베트남
        - 인도네시아, 말레이시아, 미국, 일본
        
        #### 사업 유형
        - 제조업, 무역업, 유통업
        - 서비스업, IT, 기타
        """)
    
    elif selected_section == "제품 관리":
        st.subheader("📦 제품 관리")
        
        st.markdown("""
        ### 제품 관리 기능
        
        #### 1. 제품 목록
        - 전체 제품 정보 조회
        - 카테고리별, 공급업체별 필터링
        - 제품명, 제품코드, 공급업체로 검색
        
        #### 2. 제품 등록
        **기본 정보**:
        - 제품 코드 (직접 입력 또는 표준 코드 선택)
        - 제품명, 카테고리, 공급업체
        - 원가, 추천가, 단위
        
        **세금 및 규제 정보**:
        - HS코드, 수입세율, VAT
        
        **추가 정보**:
        - 제품 설명, 사양
        - 최소 주문 수량, 리드타임
        
        #### 3. 표준 제품 코드 관리 (마스터만)
        - 표준 제품 코드 등록
        - 자동 코드 생성
        - 카테고리별 관리
        
        #### 4. 마진 자동 계산
        - 원가와 추천가 입력시 마진율 자동 계산
        - 표준 마진율 설정 가능
        
        #### 5. 대량 작업
        - CSV 파일로 대량 등록
        - 전체 제품 데이터 다운로드
        
        #### 제품 카테고리
        - 전자부품, 기계부품, 자동차부품
        - 건설자재, 화학제품, 섬유, 기타
        """)
    
    elif selected_section == "공급업체 관리":
        st.subheader("🏭 공급업체 관리")
        
        st.markdown("""
        ### 공급업체 관리 기능
        
        #### 1. 공급업체 목록
        - 전체 공급업체 정보 조회
        - 국가별, 사업유형별 필터링
        - 회사명, 담당자, 공급업체ID로 검색
        
        #### 2. 공급업체 등록
        **기본 정보**:
        - 회사명, 국가, 사업유형
        - 담당자명, 연락처, 이메일
        
        **거래 조건**:
        - 결제 조건, 리드타임
        - 최소 주문 금액, 거래 통화
        - 평점 (1~5점)
        
        **추가 정보**:
        - 주소, 은행 정보, 비고
        
        #### 3. 공급업체 평가
        - 1~5점 평점 시스템
        - 거래 이력 기반 평가
        - 평점별 공급업체 관리
        
        #### 4. 공급업체 통계
        - 국가별 분포
        - 사업유형별 분포
        - 평점 분포
        - 평균 평점
        
        #### 5. 대량 작업
        - CSV 파일로 대량 등록
        - 전체 공급업체 데이터 다운로드
        """)
    
    elif selected_section == "견적/영업 관리":
        st.subheader("💰 견적/영업 관리")
        
        st.markdown("""
        ### 견적/영업 관리 기능
        
        #### 1. 견적서 목록
        - 전체 견적서 조회
        - 상태별, 고객별 필터링
        - 기간별 조회
        
        #### 2. 견적서 작성
        **기본 정보**:
        - 고객사 선택, 견적 날짜
        - 유효 기한, 통화
        
        **제품 추가**:
        - 등록된 제품에서 선택
        - 직접 제품 정보 입력
        - 수량, 단가, 총액 자동 계산
        
        **추가 정보**:
        - 약관 및 조건, 비고
        
        #### 3. 견적서 상태 관리
        - 초안 → 발송대기 → 발송완료 → 승인됨
        - 거부됨, 만료됨 상태
        
        #### 4. PDF 생성 및 다운로드
        - 커스텀 템플릿 선택
        - 견적서 PDF 자동 생성
        - 이메일 발송용 PDF
        
        #### 5. 견적서 통계
        - 월별 견적서 현황
        - 상태별 분포
        - 고객별 견적 현황
        - 승인율 분석
        
        #### 견적서 번호 규칙
        - Q + 년월 + 순번 (예: Q202401001)
        """)
    
    elif selected_section == "비즈니스 프로세스":
        st.subheader("🔄 비즈니스 프로세스")
        
        st.markdown("""
        ### 통합 비즈니스 워크플로우
        
        #### 워크플로우 단계
        1. **견적서 승인** ✅
        2. **발주서 생성** 📋
        3. **재고 입고** 📦
        4. **배송 준비** 🚚
        5. **인보이스 발행** 💰
        6. **결제 완료** ✅
        
        #### 1. 워크플로우 생성
        - 승인된 견적서에서 자동 생성
        - 수동 워크플로우 생성 (마스터만)
        
        #### 2. 워크플로우 관리
        - 현재 단계 확인
        - 단계별 진행 상황 추적
        - 담당자 지정 및 변경
        
        #### 3. 단계별 작업
        **견적서 승인**:
        - 견적서 검토 및 승인
        - 자동으로 다음 단계 진행
        
        **발주서 생성**:
        - 공급업체 선택
        - 발주서 생성 및 발송
        
        **재고 입고**:
        - 제품 입고 확인
        - 재고 수량 업데이트
        
        **배송 준비**:
        - 배송 주소 확인
        - 배송 업체 선택
        
        **인보이스 발행**:
        - 인보이스 생성
        - 고객 발송
        
        **결제 완료**:
        - 결제 확인
        - 워크플로우 완료
        
        #### 4. 프로세스 통계
        - 단계별 워크플로우 분포
        - 완료율 및 소요 시간
        - 월별 완료 현황
        """)
    
    elif selected_section == "승인 관리":
        st.subheader("✅ 승인 관리")
        
        st.markdown("""
        ### 승인 관리 시스템
        
        #### 승인 요청 유형
        - **견적서 승인**: 고액 견적서 승인
        - **발주서 승인**: 발주 승인
        - **휴가 승인**: 직원 휴가 신청
        - **예산 승인**: 예산 사용 승인
        - **기타**: 기타 승인 요청
        
        #### 1. 승인 요청 작성 (직원)
        **요청 정보**:
        - 요청 유형, 우선순위
        - 요청 제목, 상세 사유
        - 첨부 문서
        
        **우선순위**:
        - 높음 🔴: 긴급 처리 필요
        - 보통 🟡: 일반적인 처리
        - 낮음 🟢: 여유있는 처리
        
        #### 2. 승인 처리 (마스터)
        - 승인 대기 목록 확인
        - 우선순위별 정렬
        - 승인/거부 처리
        - 거부 사유 입력
        
        #### 3. 승인 이력
        - 전체 승인 요청 이력
        - 상태별, 유형별 필터링
        - 처리 기간별 조회
        
        #### 4. 승인 통계
        - 승인율 분석
        - 요청 유형별 분포
        - 처리 시간 분석
        - 월별 승인 현황
        
        #### 승인 상태
        - **대기** ⏳: 승인 검토 중
        - **승인** ✅: 승인 완료
        - **거부** ❌: 승인 거부
        """)
    
    elif selected_section == "환율 관리":
        st.subheader("💱 환율 관리")
        
        st.markdown("""
        ### 환율 관리 시스템
        
        #### 1. 환율 현황
        - 실시간 환율 정보 조회
        - 주요 통화별 환율 카드
        - 환율 변동 추이
        
        #### 2. 환율 업데이트
        - OpenExchangeRates API 연동
        - 수동 환율 업데이트
        - 자동 업데이트 설정 (향후 기능)
        
        #### 3. 환율 이력
        - 통화별 환율 변동 이력
        - 기간별 환율 통계
        - 환율 변동 차트
        
        #### 4. 통화 변환기
        - 실시간 통화 변환
        - 여러 통화 동시 변환
        - 교차 환율 계산
        
        #### 5. 수동 환율 입력 (마스터만)
        - 특별 환율 수동 입력
        - API 미지원 통화 추가
        - 사내 환율 기준 설정
        
        #### 지원 통화
        - **KRW**: 대한민국 원
        - **VND**: 베트남 동
        - **THB**: 태국 바트
        - **CNY**: 중국 위안
        - **EUR**: 유로
        - **JPY**: 일본 엔
        
        #### 기준 통화
        - USD (미국 달러) 기준
        """)
    
    elif selected_section == "PDF 디자인":
        st.subheader("🎨 PDF 디자인")
        
        st.markdown("""
        ### PDF 템플릿 관리 (마스터만)
        
        #### 1. 템플릿 목록
        - 견적서 템플릿
        - 인보이스 템플릿
        - 템플릿별 설정 정보
        
        #### 2. 템플릿 편집
        **기본 설정**:
        - 페이지 크기 (A4/Letter)
        - 여백 설정
        
        **헤더 설정**:
        - 로고 표시 여부
        - 회사 정보 (이름, 주소, 연락처)
        - 폰트 크기 및 색상
        
        **제목 설정**:
        - 제목 텍스트
        - 폰트 크기, 색상, 정렬
        
        **테이블 설정**:
        - 표시할 컬럼 선택
        - 테이블 색상 설정
        - 헤더/행 배경색
        
        **푸터 설정**:
        - 약관 표시 (견적서)
        - 결제 정보 (인보이스)
        - 서명란 표시
        
        #### 3. 새 템플릿 생성
        - 기존 템플릿 복사
        - 커스텀 템플릿 생성
        - 템플릿 이름 및 설명
        
        #### 4. 템플릿 미리보기
        - 템플릿 설정 정보 확인
        - 색상 미리보기
        - 샘플 PDF 생성
        
        #### PDF 생성 라이브러리
        - ReportLab 사용
        - 한글 지원
        - 다양한 레이아웃 지원
        """)
    
    elif selected_section == "자주 묻는 질문":
        st.subheader("❓ 자주 묻는 질문")
        
        with st.expander("Q: 초기 로그인은 어떻게 하나요?"):
            st.markdown("""
            **A:** 시스템 초기 설정:
            1. 마스터 비밀번호: `master2024!` (기본값)
            2. 직원 계정: 먼저 마스터로 로그인하여 직원을 등록한 후 사용
            3. 직원 초기 비밀번호: `1111`
            """)
        
        with st.expander("Q: 비밀번호를 잊어버렸어요."):
            st.markdown("""
            **A:** 비밀번호 재설정:
            1. 마스터에게 문의하여 비밀번호 재설정 요청
            2. 마스터는 직원 관리에서 비밀번호 변경 가능
            3. 초기 비밀번호는 `1111`입니다
            """)
        
        with st.expander("Q: 권한이 없다고 나와요."):
            st.markdown("""
            **A:** 권한 확인:
            1. 마스터에게 권한 부여 요청
            2. 직원 관리 > 직원 권한에서 권한 설정
            3. 개인 상태 관리는 모든 직원이 접근 가능
            """)
        
        with st.expander("Q: 데이터를 백업하고 싶어요."):
            st.markdown("""
            **A:** 데이터 백업:
            1. 각 관리 메뉴의 "대량 다운로드" 기능 사용
            2. CSV 파일로 데이터 다운로드
            3. `data` 폴더의 모든 CSV 파일을 별도 보관
            """)
        
        with st.expander("Q: 환율이 업데이트되지 않아요."):
            st.markdown("""
            **A:** 환율 업데이트 문제:
            1. 인터넷 연결 상태 확인
            2. API 키 설정 확인 (환경변수)
            3. 수동 환율 입력 기능 사용
            4. 마스터 권한으로 환율 관리 접근
            """)
        
        with st.expander("Q: PDF가 생성되지 않아요."):
            st.markdown("""
            **A:** PDF 생성 문제:
            1. 템플릿 설정 확인
            2. 견적서/인보이스 데이터 완전성 확인
            3. 브라우저 팝업 차단 해제
            4. PDF 디자인 관리에서 템플릿 미리보기 테스트
            """)
        
        with st.expander("Q: 대량 업로드가 실패해요."):
            st.markdown("""
            **A:** 대량 업로드 문제:
            1. 제공된 템플릿 형식 사용
            2. 필수 컬럼 누락 확인
            3. 데이터 형식 확인 (날짜, 숫자 등)
            4. 파일 인코딩 UTF-8 확인
            """)
        
        with st.expander("Q: 시스템이 느려요."):
            st.markdown("""
            **A:** 성능 최적화:
            1. 불필요한 탭/브라우저 창 닫기
            2. 큰 데이터 조회시 필터 사용
            3. 정기적인 데이터 정리
            4. 브라우저 캐시 정리
            """)
        
        st.info("💡 **추가 도움이 필요한 경우**: 시스템 관리자에게 문의하세요.")
