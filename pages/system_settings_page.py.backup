"""
ì‹œìŠ¤í…œ ì„¤ì • í˜ì´ì§€ - ì œí’ˆ ë¶„ë¥˜ ê´€ë¦¬ ì¤‘ì‹¬
"""

import streamlit as st
import pandas as pd
import os
from datetime import datetime

def show_system_settings_page(config_manager, get_text, hide_header=False):
    """ì‹œìŠ¤í…œ ì„¤ì • ë©”ì¸ í˜ì´ì§€"""
    
    if not hide_header:
        st.header("âš™ï¸ ì‹œìŠ¤í…œ ì„¤ì •")
        st.caption("ì œí’ˆ ë¶„ë¥˜, íšŒì‚¬ ì •ë³´, ì‹œìŠ¤í…œ ì˜µì…˜ì„ ê´€ë¦¬í•©ë‹ˆë‹¤")
    
    # ì œí’ˆ ì¹´í…Œê³ ë¦¬ ì„¤ì • ê´€ë¦¬ì í™•ì¸
    if config_manager is None:
        try:
            from product_category_config_manager import ProductCategoryConfigManager
            config_manager = ProductCategoryConfigManager()
        except Exception as e:
            st.error(f"ì‹œìŠ¤í…œ ì„¤ì • ê´€ë¦¬ì ì´ˆê¸°í™” ì˜¤ë¥˜: {e}")
            return
    
    # 3ê°œ ì£¼ìš” íƒ­
    tabs = st.tabs([
        "ğŸ“‹ ì œí’ˆ ë¶„ë¥˜ ê´€ë¦¬", 
        "ğŸ¢ íšŒì‚¬ ì •ë³´ ì„¤ì •", 
        "ğŸ”§ ì‹œìŠ¤í…œ ì˜µì…˜"
    ])
    
    with tabs[0]:  # ì œí’ˆ ë¶„ë¥˜ ê´€ë¦¬
        show_product_category_management(config_manager)
    
    with tabs[1]:  # íšŒì‚¬ ì •ë³´ ì„¤ì •
        show_company_info_settings()
    
    with tabs[2]:  # ì‹œìŠ¤í…œ ì˜µì…˜
        show_system_options()

def show_product_category_management(config_manager):
    """ì œí’ˆ ë¶„ë¥˜ ê´€ë¦¬ íƒ­"""
    st.subheader("ğŸ“‹ ì œí’ˆ ë¶„ë¥˜ ê´€ë¦¬")
    st.caption("ì œí’ˆ ì¹´í…Œê³ ë¦¬, ì„œë¸Œ ì¹´í…Œê³ ë¦¬, ì¬ì§ˆ ë“±ì„ ë™ì ìœ¼ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤")
    
    # ì„¸ì…˜ ìƒíƒœì—ì„œ ì„ íƒëœ íƒ­ í™•ì¸
    default_tab_index = 0
    if 'settings_tab' in st.session_state and st.session_state['settings_tab'] == 'HR ì œí’ˆ ì½”ë“œ êµ¬ì„±':
        default_tab_index = 1  # HR ì„¸ë¶€ì„¤ì • íƒ­
    
    # ì¹´í…Œê³ ë¦¬ ê´€ë¦¬ ì„¸ë¶€ íƒ­
    category_tabs = st.tabs([
        "ğŸ·ï¸ ë©”ì¸ ì¹´í…Œê³ ë¦¬",
        "ğŸ—ï¸ HR ì œí’ˆ ì½”ë“œ êµ¬ì„±"
    ])
    
    with category_tabs[0]:
        show_main_categories(config_manager)
    
    with category_tabs[1]:
        # HR ì œí’ˆ ì½”ë“œ êµ¬ì„± ê´€ë¦¬ (ì œì¡°ì‚¬/ì›ì‚°ì§€ ê´€ë¦¬ í¬í•¨)
        show_hr_subcategories(config_manager)

def show_main_categories(config_manager):
    """ë©”ì¸ ì¹´í…Œê³ ë¦¬ ê´€ë¦¬"""
    st.subheader("ğŸ·ï¸ ë©”ì¸ ì¹´í…Œê³ ë¦¬ ê´€ë¦¬")
    st.caption("ì œí’ˆ ì¹´í…Œê³ ë¦¬, ì„œë¸Œ ì¹´í…Œê³ ë¦¬, ì¬ì§ˆ ë“±ì„ ë™ì ìœ¼ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤")
    
    # í˜„ì¬ ë©”ì¸ ì¹´í…Œê³ ë¦¬ í‘œì‹œ
    st.write("**í˜„ì¬ ë©”ì¸ ì¹´í…Œê³ ë¦¬:**")
    
    # ê¸°ë³¸ ì¹´í…Œê³ ë¦¬ ì •ì˜
    default_categories = [
        ("HR", "Hot Runner", "í•«ëŸ¬ë„ˆ ì‹œìŠ¤í…œ")
    ]
    
    # 3ì—´ë¡œ ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ ë°°ì¹˜
    cols = st.columns(3)
    for i, (category_key, category_name, description) in enumerate(default_categories):
        with cols[i % 3]:
            # HRC ì¹´í…Œê³ ë¦¬ëŠ” Controllerë¡œ í‘œì‹œ
            display_text = "Controller" if category_key == "HRC" else category_key
            if st.button(f"**{display_text}**", key=f"main_cat_{category_key}", use_container_width=True, help=description):
                st.session_state['selected_main_category'] = category_key
                st.rerun()
    
    # ì„ íƒëœ ì¹´í…Œê³ ë¦¬ì˜ ì œí’ˆ ëª©ë¡ í‘œì‹œ
    if 'selected_main_category' in st.session_state:
        show_category_products(st.session_state['selected_main_category'])
    
    # ìƒˆ ë©”ì¸ ì¹´í…Œê³ ë¦¬ ì¶”ê°€ í™•ì¥ì
    with st.expander("â• ìƒˆ ë©”ì¸ ì¹´í…Œê³ ë¦¬ ì¶”ê°€"):
        with st.form("add_main_category"):
            new_key = st.text_input("ì¹´í…Œê³ ë¦¬ í‚¤", placeholder="ì˜ˆ: ROBOT")
            new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: ë¡œë´‡ ì‹œìŠ¤í…œ")
            
            if st.form_submit_button("ğŸ”„ ë©”ì¸ ì¹´í…Œê³ ë¦¬ ì¶”ê°€"):
                if new_key:
                    try:
                        success, result = config_manager.add_category(
                            'main_category', None, new_key, new_key, None, None, new_description
                        )
                        if success:
                            st.success(f"ë©”ì¸ ì¹´í…Œê³ ë¦¬ '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                        else:
                            st.error(f"ì¹´í…Œê³ ë¦¬ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {result}")
                    except:
                        st.info("ê¸°ë³¸ ì¹´í…Œê³ ë¦¬ëŠ” ì´ë¯¸ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.")
                else:
                    st.warning("ì¹´í…Œê³ ë¦¬ í‚¤ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.")

def show_category_products(category_key):
    """ì„ íƒëœ ì¹´í…Œê³ ë¦¬ì˜ ë“±ë¡ëœ ì œí’ˆë“¤ì„ í…Œì´ë¸”ë¡œ í‘œì‹œ"""
    # HRC ì¹´í…Œê³ ë¦¬ëŠ” Controllerë¡œ í‘œì‹œ
    display_name = "Controller" if category_key == "HRC" else category_key
    st.markdown(f"### ğŸ“¦ {display_name} ì¹´í…Œê³ ë¦¬ ë“±ë¡ ì œí’ˆ")
    
    try:
        import sqlite3
        import pandas as pd
        
        # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° - SQLite ë§¤ë‹ˆì €ì™€ ë™ì¼í•œ ê²½ë¡œ ì‚¬ìš©
        from managers.sqlite.sqlite_master_product_manager import SQLiteMasterProductManager
        
        # ì‹¤ì œ ì‚¬ìš©í•˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ê²½ë¡œ ê°€ì ¸ì˜¤ê¸°
        master_manager = SQLiteMasterProductManager()
        db_path = master_manager.db_path
        
        conn = sqlite3.connect(db_path)
        cursor = conn.cursor()
        
        # í†µí•© ì œí’ˆê³¼ íŒë§¤ ì œí’ˆì—ì„œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ ì œí’ˆ ì¡°íšŒ (ì •í™•íˆ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¡œ ì‹œì‘í•˜ëŠ” ê²ƒë§Œ)
        # HRì˜ ê²½ìš° HRCëŠ” ì œì™¸í•˜ê³ , MBì˜ ê²½ìš° MB+HRëŠ” ì œì™¸
        if category_key == 'HR':
            where_condition = "product_code LIKE 'HR-%' AND product_code NOT LIKE 'HRC-%' AND product_code NOT LIKE 'HR+%'"
        elif category_key == 'HRC':
            where_condition = "product_code LIKE 'HRC-%'"
        elif category_key == 'MB':
            where_condition = "product_code LIKE 'MB-%' AND product_code NOT LIKE 'MB+HR-%'"
        elif category_key == 'MB+HR':
            where_condition = "product_code LIKE 'MB+HR-%'"
        elif category_key in ['SPARE-HR', 'SPARE-MB', 'SPARE-ROBOT']:
            spare_type = category_key.split('-')[1]
            where_condition = f"product_code LIKE 'SPARE-{spare_type}-%' OR product_code LIKE 'SP-{spare_type}-%'"
        else:
            where_condition = f"product_code LIKE '{category_key}-%'"
        
        # HR, HRC ì¹´í…Œê³ ë¦¬ì˜ ê²½ìš° ì œì¡°ì‚¬, ê³µê¸‰ì²˜, ì›ì‚°ì§€ ì»¬ëŸ¼ ì œì™¸ (ê¹”ë”í•œ í‘œì‹œ)
        if category_key in ['HR', 'HRC']:
            cursor.execute(f'''
                SELECT 
                    product_code,
                    product_name as name_korean,
                    'MASTER' as product_type,
                    created_date
                FROM master_products
                WHERE {where_condition}
                
                UNION ALL
                
                SELECT 
                    product_code,
                    product_name as name_korean,
                    'SALES' as product_type,
                    created_date
                FROM sales_products
                WHERE {where_condition}
                
                ORDER BY product_code
            ''')
        else:
            cursor.execute(f'''
                SELECT 
                    product_code,
                    product_name as name_korean,
                    manufacturer,
                    supplier_name,
                    origin_country,
                    'MASTER' as product_type,
                    created_date
                FROM master_products
                WHERE {where_condition}
                
                UNION ALL
                
                SELECT 
                    product_code,
                    product_name as name_korean,
                    brand as manufacturer,
                    '' as supplier_name,
                    '' as origin_country,
                    'SALES' as product_type,
                    created_date
                FROM sales_products
                WHERE {where_condition}
                
                ORDER BY product_code
            ''')
        
        products = cursor.fetchall()
        conn.close()
        
        if products:
            # HR, HRC ì¹´í…Œê³ ë¦¬ì™€ ë‹¤ë¥¸ ì¹´í…Œê³ ë¦¬ì— ë”°ë¼ DataFrame ì»¬ëŸ¼ êµ¬ì„± ë‹¤ë¥´ê²Œ ì²˜ë¦¬
            if category_key in ['HR', 'HRC']:
                # HR, HRC ì¹´í…Œê³ ë¦¬: ì œí’ˆì½”ë“œ, ì œí’ˆëª…, íƒ€ì…, ë“±ë¡ì¼ë§Œ (ê¹”ë”í•œ í‘œì‹œ)
                columns = ['ì œí’ˆì½”ë“œ', 'ì œí’ˆëª…', 'íƒ€ì…', 'ë“±ë¡ì¼']
                df = pd.DataFrame(products, columns=columns)
                column_config = {
                    "ì œí’ˆì½”ë“œ": st.column_config.TextColumn("ì œí’ˆì½”ë“œ", width="medium"),
                    "ì œí’ˆëª…": st.column_config.TextColumn("ì œí’ˆëª…", width="large"),
                    "íƒ€ì…": st.column_config.TextColumn("íƒ€ì…", width="small"),
                    "ë“±ë¡ì¼": st.column_config.DatetimeColumn("ë“±ë¡ì¼", width="medium")
                }
            else:
                # ë‹¤ë¥¸ ì¹´í…Œê³ ë¦¬: ëª¨ë“  ì»¬ëŸ¼ í¬í•¨
                columns = ['ì œí’ˆì½”ë“œ', 'ì œí’ˆëª…', 'ì œì¡°ì‚¬', 'ê³µê¸‰ì²˜', 'ì›ì‚°ì§€', 'íƒ€ì…', 'ë“±ë¡ì¼']
                df = pd.DataFrame(products, columns=columns)
                column_config = {
                    "ì œí’ˆì½”ë“œ": st.column_config.TextColumn("ì œí’ˆì½”ë“œ", width="medium"),
                    "ì œí’ˆëª…": st.column_config.TextColumn("ì œí’ˆëª…", width="large"),
                    "ì œì¡°ì‚¬": st.column_config.TextColumn("ì œì¡°ì‚¬", width="medium"),
                    "ê³µê¸‰ì²˜": st.column_config.TextColumn("ê³µê¸‰ì²˜", width="medium"),
                    "ì›ì‚°ì§€": st.column_config.TextColumn("ì›ì‚°ì§€", width="small"),
                    "íƒ€ì…": st.column_config.TextColumn("íƒ€ì…", width="small"),
                    "ë“±ë¡ì¼": st.column_config.DatetimeColumn("ë“±ë¡ì¼", width="medium")
                }
            
            # í…Œì´ë¸” í‘œì‹œ
            st.dataframe(
                df,
                use_container_width=True,
                hide_index=True,
                column_config=column_config
            )
            
            # ìš”ì•½ ì •ë³´
            total_count = len(products)
            master_count = len(df[df['íƒ€ì…'] == 'MASTER'])
            sales_count = len(df[df['íƒ€ì…'] == 'SALES'])
            
            col1, col2, col3, col4 = st.columns(4)
            with col1:
                st.metric("ì´ ì œí’ˆ", total_count)
            with col2:
                st.metric("í†µí•© ì œí’ˆ", master_count)
            with col3:
                st.metric("íŒë§¤ ì œí’ˆ", sales_count)
            with col4:
                if st.button("ğŸ”„ ìƒˆë¡œê³ ì¹¨", key=f"refresh_{category_key}"):
                    st.rerun()
            
            # ì œí’ˆ ê´€ë¦¬ ì„¸ë¶€ ì„¤ì •
            st.markdown("---")
            st.markdown("### âš™ï¸ ì œí’ˆ ê´€ë¦¬ ì„¸ë¶€ì„¤ì •")
            
            col_manage1, col_manage2 = st.columns(2)
            
            with col_manage1:
                st.markdown("#### ğŸ“‹ íŒë§¤ ì œí’ˆ ë“±ë¡")
                
                # í†µí•© ì œí’ˆ ì¤‘ íŒë§¤ ì œí’ˆì— ì—†ëŠ” ê²ƒë“¤ ì¡°íšŒ
                try:
                    conn = sqlite3.connect(db_path)
                    cursor = conn.cursor()
                    
                    cursor.execute(f'''
                        SELECT m.product_code, m.product_name
                        FROM master_products m
                        WHERE {where_condition}
                        AND m.product_code NOT IN (
                            SELECT product_code FROM sales_products 
                            WHERE {where_condition}
                        )
                        ORDER BY m.product_code
                    ''')
                    
                    available_products = cursor.fetchall()
                    conn.close()
                    
                    if available_products:
                        product_options = [f"{code} - {name}" for code, name in available_products]
                        
                        selected_product = st.selectbox(
                            "íŒë§¤ ì œí’ˆìœ¼ë¡œ ë“±ë¡í•  ì œí’ˆ ì„ íƒ",
                            [""] + product_options,
                            key=f"select_product_{category_key}"
                        )
                        
                        if selected_product and st.button("ğŸ“‹ íŒë§¤ ì œí’ˆìœ¼ë¡œ ë“±ë¡", key=f"add_sales_{category_key}"):
                            product_code = selected_product.split(" - ")[0]
                            product_name = selected_product.split(" - ")[1]
                            
                            # íŒë§¤ ì œí’ˆ ë“±ë¡
                            try:
                                from managers.sqlite.sqlite_sales_product_manager import SQLiteSalesProductManager
                                sales_manager = SQLiteSalesProductManager()
                                
                                sales_data = {
                                    'product_code': product_code,
                                    'product_name': product_name,
                                    'category': category_key,
                                    'price': 0,
                                    'currency': 'VND'
                                }
                                
                                result = sales_manager.add_sales_product(sales_data)
                                if result:
                                    st.success(f"âœ… {product_code} ì œí’ˆì´ íŒë§¤ ì œí’ˆìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.")
                                    st.rerun()
                                else:
                                    st.error("âŒ íŒë§¤ ì œí’ˆ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")
                            except Exception as e:
                                st.error(f"âŒ ì˜¤ë¥˜: {str(e)}")
                    else:
                        st.info("íŒë§¤ ì œí’ˆìœ¼ë¡œ ë“±ë¡í•  ìˆ˜ ìˆëŠ” í†µí•© ì œí’ˆì´ ì—†ìŠµë‹ˆë‹¤.")
                        
                except Exception as e:
                    st.error(f"ì œí’ˆ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜: {str(e)}")
            
            with col_manage2:
                st.markdown("#### ğŸ—‘ï¸ ì œí’ˆ ì‚­ì œ")
                
                if total_count > 0:
                    # ì œí’ˆ ì‚­ì œ ì„ íƒ
                    product_options_del = [f"{row['ì œí’ˆì½”ë“œ']} - {row['ì œí’ˆëª…']} ({row['íƒ€ì…']})" for _, row in df.iterrows()]
                    
                    selected_product_del = st.selectbox(
                        "ì‚­ì œí•  ì œí’ˆ ì„ íƒ",
                        [""] + product_options_del,
                        key=f"select_delete_{category_key}"
                    )
                    
                    if selected_product_del:
                        product_code_del = selected_product_del.split(" - ")[0]
                        product_type_del = selected_product_del.split("(")[1].replace(")", "")
                        
                        st.warning(f"âš ï¸ **{product_code_del}** ì œí’ˆì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")
                        st.caption("ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
                        
                        if st.button("ğŸ—‘ï¸ ì œí’ˆ ì‚­ì œ", key=f"delete_product_{category_key}", type="secondary"):
                            try:
                                conn = sqlite3.connect(db_path)
                                cursor = conn.cursor()
                                
                                deleted_count = 0
                                if product_type_del == "MASTER":
                                    # ë¨¼ì € master_product_id ì¡°íšŒ
                                    cursor.execute("SELECT master_product_id FROM master_products WHERE product_code = ?", (product_code_del,))
                                    result = cursor.fetchone()
                                    if result:
                                        master_product_id = result[0]
                                        # ê´€ë ¨ ì¬ê³ /ê°€ê²© ë°ì´í„°ë„ í•¨ê»˜ ì‚­ì œ (ì˜¬ë°”ë¥¸ ì»¬ëŸ¼ëª… ì‚¬ìš©)
                                        cursor.execute("DELETE FROM master_product_inventory WHERE master_product_id = ?", (master_product_id,))
                                        cursor.execute("DELETE FROM master_product_prices WHERE master_product_id = ?", (master_product_id,))
                                        cursor.execute("DELETE FROM master_products WHERE product_code = ?", (product_code_del,))
                                        deleted_count = cursor.rowcount
                                        deleted_table = "í†µí•© ì œí’ˆ"
                                    else:
                                        deleted_count = 0
                                else:
                                    cursor.execute("DELETE FROM sales_products WHERE product_code = ?", (product_code_del,))
                                    deleted_count = cursor.rowcount
                                    deleted_table = "íŒë§¤ ì œí’ˆ"
                                
                                if deleted_count > 0:
                                    conn.commit()
                                    st.success(f"âœ… {product_code_del} ì œí’ˆì´ {deleted_table}ì—ì„œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤. (ì‚­ì œëœ í–‰: {deleted_count}ê°œ)")
                                    st.rerun()
                                else:
                                    st.warning(f"âš ï¸ {product_code_del} ì œí’ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
                                
                                conn.close()
                                
                            except Exception as e:
                                st.error(f"âŒ ì‚­ì œ ì¤‘ ì˜¤ë¥˜: {str(e)}")
                                if 'conn' in locals():
                                    conn.close()
                else:
                    st.info("ì‚­ì œí•  ì œí’ˆì´ ì—†ìŠµë‹ˆë‹¤.")
        else:
            display_name = "Controller" if category_key == "HRC" else category_key
            st.info(f"{display_name} ì¹´í…Œê³ ë¦¬ì— ë“±ë¡ëœ ì œí’ˆì´ ì—†ìŠµë‹ˆë‹¤.")
            
    except Exception as e:
        st.error(f"ì œí’ˆ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {e}")
    
    # ë’«ìœ¼ë¡œ ê°€ê¸° ë²„íŠ¼
    if st.button("â¬…ï¸ ì¹´í…Œê³ ë¦¬ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°", key=f"back_{category_key}"):
        if 'selected_main_category' in st.session_state:
            del st.session_state['selected_main_category']
        st.rerun()

def show_hr_subcategories(config_manager):
    """HR ì œí’ˆ ì½”ë“œ êµ¬ì„± ìš”ì†Œ ê´€ë¦¬"""
    st.subheader("ğŸ—ï¸ HR ì œí’ˆ ì½”ë“œ êµ¬ì„± ê´€ë¦¬")
    st.caption("HR ì¹´í…Œê³ ë¦¬ì˜ System Type, ì œí’ˆ íƒ€ì…, ê²Œì´íŠ¸ íƒ€ì…, ì‚¬ì´ì¦ˆë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤")
    
    # ì„¸ì…˜ ìƒíƒœ ì´ˆê¸°í™”
    if 'hr_component_tab' in st.session_state:
        del st.session_state['hr_component_tab']
    if 'settings_tab' in st.session_state:
        del st.session_state['settings_tab']
    
    # HR êµ¬ì„± ìš”ì†Œ ê´€ë¦¬ íƒ­
    hr_tabs = st.tabs([
        "ğŸ”§ System Type", 
        "ğŸ“‹ ì œí’ˆ íƒ€ì…", 
        "ğŸšª ê²Œì´íŠ¸ íƒ€ì…", 
        "ğŸ“ ì‚¬ì´ì¦ˆ"
    ])
    
    with hr_tabs[0]:
        manage_hr_system_types(config_manager)
    
    with hr_tabs[1]:
        manage_hr_product_types(config_manager)
    
    with hr_tabs[2]:
        manage_hr_gate_types(config_manager)
    
    with hr_tabs[3]:
        manage_hr_sizes(config_manager)

def manage_hr_system_types(config_manager):
    """System Type ê´€ë¦¬"""
    st.subheader("ğŸ”§ System Type ê´€ë¦¬")
    
    # í˜„ì¬ System Type ëª©ë¡ í‘œì‹œ
    system_types = config_manager.get_hr_components_for_management('system_type')
    
    if system_types:
        st.write("**í˜„ì¬ System Types:**")
        for st_type in system_types:
            if st_type['is_active']:
                col1, col2, col3 = st.columns([6, 1, 1])
                with col1:
                    st.write(f"**{st_type['component_key']}** - {st_type['component_name']}")
                    if st_type['description']:
                        st.caption(st_type['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_st_{st_type['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_st_{st_type['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_st_{st_type['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(st_type['component_id']):
                            st.success("System Typeì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                
                # ìˆ˜ì • í¼ í‘œì‹œ
                if st.session_state.get(f"editing_st_{st_type['component_id']}", False):
                    with st.expander("âœï¸ System Type ìˆ˜ì •", expanded=True):
                        with st.form(f"edit_system_type_{st_type['component_id']}"):
                            new_key = st.text_input("í‚¤", value=st_type['component_key'])
                            new_description = st.text_input("ì„¤ëª…", value=st_type['description'] or "")
                            
                            col_submit, col_cancel = st.columns([1, 1])
                            with col_submit:
                                if st.form_submit_button("ğŸ’¾ ì €ì¥"):
                                    if config_manager.update_hr_component(
                                        st_type['component_id'], component_key=new_key, 
                                        component_name=new_key, description=new_description
                                    ):
                                        st.success("System Typeì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                        del st.session_state[f"editing_st_{st_type['component_id']}"]
                                        st.rerun()
                                    else:
                                        st.error("ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                            with col_cancel:
                                if st.form_submit_button("âŒ ì·¨ì†Œ"):
                                    del st.session_state[f"editing_st_{st_type['component_id']}"]
                                    st.rerun()
    
    # ìƒˆ System Type ì¶”ê°€
    with st.expander("â• ìƒˆ System Type ì¶”ê°€"):
        with st.form("add_system_type"):
            new_key = st.text_input("í‚¤", placeholder="ì˜ˆ: Coil")
            new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: ì½”ì¼í˜• í•«ëŸ¬ë„ˆ ì‹œìŠ¤í…œ")
            
            if st.form_submit_button("â• System Type ì¶”ê°€"):
                if new_key:
                    success = config_manager.add_hr_component(
                        'system_type', None, new_key, new_key, None, None, new_description
                    )
                    if success:
                        st.success(f"System Type '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                        st.rerun()
                    else:
                        st.error("System Type ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (ì¤‘ë³µëœ í‚¤ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤)")
                else:
                    st.warning("í‚¤ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.")

def manage_hr_product_types(config_manager):
    """Product Type ê´€ë¦¬"""
    st.subheader("ğŸ“‹ ì œí’ˆ íƒ€ì… ê´€ë¦¬")
    
    # System Type ì„ íƒ
    system_types = config_manager.get_hr_system_types()
    
    if not system_types:
        st.warning("ë¨¼ì € System Typeì„ ë“±ë¡í•´ì£¼ì„¸ìš”.")
        return
    
    selected_system = st.selectbox("System Type ì„ íƒ", [""] + system_types)
    
    if selected_system:
        # ì„ íƒëœ System Typeì˜ Product Type ëª©ë¡
        product_types = config_manager.get_hr_components_for_management('product_type')
        filtered_types = [pt for pt in product_types if pt['parent_component'] == selected_system and pt['is_active']]
        
        if filtered_types:
            st.write(f"**{selected_system}ì˜ ì œí’ˆ íƒ€ì…:**")
            for pt in filtered_types:
                col1, col2, col3 = st.columns([3, 1, 1])
                with col1:
                    st.write(f"â€¢ **{pt['component_key']}** - {pt['component_name']}")
                    if pt['description']:
                        st.caption(pt['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_pt_{pt['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_pt_{pt['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_pt_{pt['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(pt['component_id']):
                            st.success("ì œí’ˆ íƒ€ì…ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                
                # ìˆ˜ì • í¼ í‘œì‹œ
                if st.session_state.get(f"editing_pt_{pt['component_id']}", False):
                    with st.expander("âœï¸ ì œí’ˆ íƒ€ì… ìˆ˜ì •", expanded=True):
                        with st.form(f"edit_product_type_{pt['component_id']}"):
                            new_key = st.text_input("í‚¤", value=pt['component_key'])
                            new_description = st.text_input("ì„¤ëª…", value=pt['description'] or "")
                            
                            col_submit, col_cancel = st.columns([1, 1])
                            with col_submit:
                                if st.form_submit_button("ğŸ’¾ ì €ì¥"):
                                    if config_manager.update_hr_component(
                                        pt['component_id'], component_key=new_key, 
                                        component_name=new_key, description=new_description
                                    ):
                                        st.success("ì œí’ˆ íƒ€ì…ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                        del st.session_state[f"editing_pt_{pt['component_id']}"]
                                        st.rerun()
                                    else:
                                        st.error("ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                            with col_cancel:
                                if st.form_submit_button("âŒ ì·¨ì†Œ"):
                                    del st.session_state[f"editing_pt_{pt['component_id']}"]
                                    st.rerun()
        else:
            st.info(f"{selected_system}ì— ë“±ë¡ëœ ì œí’ˆ íƒ€ì…ì´ ì—†ìŠµë‹ˆë‹¤.")
        
        # ìƒˆ Product Type ì¶”ê°€
        with st.expander(f"â• {selected_system}ì— ìƒˆ ì œí’ˆ íƒ€ì… ì¶”ê°€"):
            with st.form(f"add_product_type_{selected_system}"):
                new_key = st.text_input("í‚¤", placeholder="ì˜ˆ: ST")
                new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: í‘œì¤€í˜• ì œí’ˆ")
                
                if st.form_submit_button("â• ì œí’ˆ íƒ€ì… ì¶”ê°€"):
                    if new_key:
                        success = config_manager.add_hr_component(
                            'product_type', selected_system, new_key, new_key, 
                            None, None, new_description
                        )
                        if success:
                            st.success(f"ì œí’ˆ íƒ€ì… '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                        else:
                            st.error("ì œí’ˆ íƒ€ì… ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                    else:
                        st.warning("í‚¤ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.")

def manage_hr_gate_types(config_manager):
    """Gate Type ê´€ë¦¬"""
    st.subheader("ğŸšª ê²Œì´íŠ¸ íƒ€ì… ê´€ë¦¬")
    
    # System Typeê³¼ Product Type ì„ íƒ
    system_types = config_manager.get_hr_system_types()
    
    if not system_types:
        st.warning("ë¨¼ì € System Typeì„ ë“±ë¡í•´ì£¼ì„¸ìš”.")
        return
    
    col1, col2 = st.columns(2)
    with col1:
        selected_system = st.selectbox("System Type", [""] + system_types, key="gate_system")
    
    with col2:
        if selected_system:
            product_types = config_manager.get_hr_product_types(selected_system)
            selected_product = st.selectbox("ì œí’ˆ íƒ€ì…", [""] + product_types, key="gate_product")
        else:
            selected_product = None
    
    if selected_system and selected_product:
        parent_key = f"{selected_system}-{selected_product}"
        
        # Gate Type ëª©ë¡ í‘œì‹œ
        gate_types = config_manager.get_hr_components_for_management('gate_type')
        filtered_gates = [gt for gt in gate_types if gt['parent_component'] == parent_key and gt['is_active']]
        
        if filtered_gates:
            st.write(f"**{selected_system}-{selected_product}ì˜ ê²Œì´íŠ¸ íƒ€ì…:**")
            for gt in filtered_gates:
                col1, col2, col3 = st.columns([3, 1, 1])
                with col1:
                    st.write(f"â€¢ **{gt['component_key']}** - {gt['component_name']}")
                    if gt['description']:
                        st.caption(gt['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_gt_{gt['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_gt_{gt['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_gt_{gt['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(gt['component_id']):
                            st.success("ê²Œì´íŠ¸ íƒ€ì…ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                
                # ìˆ˜ì • í¼ í‘œì‹œ
                if st.session_state.get(f"editing_gt_{gt['component_id']}", False):
                    with st.expander("âœï¸ ê²Œì´íŠ¸ íƒ€ì… ìˆ˜ì •", expanded=True):
                        with st.form(f"edit_gate_type_{gt['component_id']}"):
                            new_key = st.text_input("í‚¤", value=gt['component_key'])
                            new_description = st.text_input("ì„¤ëª…", value=gt['description'] or "")
                            
                            col_submit, col_cancel = st.columns([1, 1])
                            with col_submit:
                                if st.form_submit_button("ğŸ’¾ ì €ì¥"):
                                    if config_manager.update_hr_component(
                                        gt['component_id'], component_key=new_key, 
                                        component_name=new_key, description=new_description
                                    ):
                                        st.success("ê²Œì´íŠ¸ íƒ€ì…ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                        del st.session_state[f"editing_gt_{gt['component_id']}"]
                                        st.rerun()
                                    else:
                                        st.error("ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                            with col_cancel:
                                if st.form_submit_button("âŒ ì·¨ì†Œ"):
                                    del st.session_state[f"editing_gt_{gt['component_id']}"]
                                    st.rerun()
        
        # ìƒˆ Gate Type ì¶”ê°€
        with st.expander(f"â• {parent_key}ì— ìƒˆ ê²Œì´íŠ¸ íƒ€ì… ì¶”ê°€"):
            # ê³ ìœ í•œ í¼ í‚¤ ì‚¬ìš©
            form_key = f"add_gate_type_{parent_key.replace('-', '_')}"
            with st.form(form_key):
                new_key = st.text_input("í‚¤", placeholder="ì˜ˆ: MAE", key=f"gt_key_{parent_key}")
                new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: MAE íƒ€ì… ê²Œì´íŠ¸", key=f"gt_desc_{parent_key}")
                
                if st.form_submit_button("â• ê²Œì´íŠ¸ íƒ€ì… ì¶”ê°€"):
                    if new_key.strip():
                        try:
                            success = config_manager.add_hr_component(
                                'gate_type', parent_key, new_key.strip(), new_key.strip(), 
                                None, None, new_description.strip() if new_description else None
                            )
                            if success:
                                st.success(f"âœ… ê²Œì´íŠ¸ íƒ€ì… '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                # ì„¸ì…˜ ìƒíƒœ ì´ˆê¸°í™”ë¡œ ìƒˆë¡œê³ ì¹¨ íš¨ê³¼
                                if 'gate_type_refresh' in st.session_state:
                                    del st.session_state['gate_type_refresh']
                                st.rerun()
                            else:
                                st.error("âŒ ê²Œì´íŠ¸ íƒ€ì… ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (ì¤‘ë³µëœ í‚¤ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤)")
                        except Exception as e:
                            st.error(f"âŒ ì˜¤ë¥˜: {str(e)}")
                    else:
                        st.warning("âš ï¸ í‚¤ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.")

def manage_hr_sizes(config_manager):
    """Size ê´€ë¦¬"""
    st.subheader("ğŸ“ ì‚¬ì´ì¦ˆ ê´€ë¦¬")
    
    # System Typeê³¼ Product Type ì„ íƒ
    system_types = config_manager.get_hr_system_types()
    
    if not system_types:
        st.warning("ë¨¼ì € System Typeì„ ë“±ë¡í•´ì£¼ì„¸ìš”.")
        return
    
    col1, col2, col3 = st.columns(3)
    with col1:
        selected_system = st.selectbox("System Type", [""] + system_types, key="size_system")
    
    with col2:
        if selected_system:
            product_types = config_manager.get_hr_product_types(selected_system)
            selected_product = st.selectbox("ì œí’ˆ íƒ€ì…", [""] + product_types, key="size_product")
        else:
            selected_product = None
    
    with col3:
        if selected_system and selected_product:
            gate_types = config_manager.get_hr_gate_types(selected_system, selected_product)
            selected_gate = st.selectbox("ê²Œì´íŠ¸ íƒ€ì…", [""] + gate_types, key="size_gate")
        else:
            selected_gate = None
    
    if selected_system and selected_product and selected_gate:
        parent_key = f"{selected_system}-{selected_product}-{selected_gate}"
        
        # Size ëª©ë¡ í‘œì‹œ
        sizes = config_manager.get_hr_components_for_management('size')
        filtered_sizes = [sz for sz in sizes if sz['parent_component'] == parent_key and sz['is_active']]
        
        if filtered_sizes:
            st.write(f"**{selected_system}-{selected_product}-{selected_gate}ì˜ ì‚¬ì´ì¦ˆ:**")
            for sz in filtered_sizes:
                col1, col2, col3 = st.columns([3, 1, 1])
                with col1:
                    st.write(f"â€¢ **{sz['component_key']}** - {sz['component_name']}")
                    if sz['description']:
                        st.caption(sz['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_sz_{sz['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_sz_{sz['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_sz_{sz['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(sz['component_id']):
                            st.success("ì‚¬ì´ì¦ˆê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                
                # ìˆ˜ì • í¼ í‘œì‹œ
                if st.session_state.get(f"editing_sz_{sz['component_id']}", False):
                    with st.expander("âœï¸ ì‚¬ì´ì¦ˆ ìˆ˜ì •", expanded=True):
                        with st.form(f"edit_size_{sz['component_id']}"):
                            new_key = st.text_input("í‚¤", value=sz['component_key'])
                            new_description = st.text_input("ì„¤ëª…", value=sz['description'] or "")
                            
                            col_submit, col_cancel = st.columns([1, 1])
                            with col_submit:
                                if st.form_submit_button("ğŸ’¾ ì €ì¥"):
                                    old_size = sz['component_key']
                                    
                                    if config_manager.update_hr_component(
                                        sz['component_id'], component_key=new_key, 
                                        component_name=new_key, description=new_description
                                    ):
                                        st.success("ì‚¬ì´ì¦ˆê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                        
                                        # ì‚¬ì´ì¦ˆ ë³€ê²½ ì‹œ ê´€ë ¨ ì œí’ˆë“¤ ìë™ ì—…ë°ì´íŠ¸
                                        if old_size != new_key:
                                            st.info(f"ğŸ”„ ì‚¬ì´ì¦ˆ ë³€ê²½ ê°ì§€: {old_size} â†’ {new_key}")
                                            try:
                                                from managers.sqlite.sqlite_master_product_manager import SQLiteMasterProductManager
                                                master_manager = SQLiteMasterProductManager()
                                                
                                                # parent_keyì—ì„œ System Type, Product Type, Gate Type ì¶”ì¶œ
                                                parts = parent_key.split('-')
                                                st.info(f"ğŸ“‹ Parent Key ë¶„ì„: {parent_key} â†’ {parts}")
                                                
                                                if len(parts) == 3:
                                                    system_type, product_type, gate_type = parts
                                                    
                                                    # System Type ì½”ë“œ ë³€í™˜
                                                    system_type_code = ""
                                                    if system_type == "Valve":
                                                        system_type_code = "VV"
                                                    elif system_type == "Open":
                                                        system_type_code = "OP"
                                                    else:
                                                        system_type_code = system_type[:2].upper()
                                                    
                                                    # ê¸°ì¡´ ë° ìƒˆë¡œìš´ ì œí’ˆ ì½”ë“œ
                                                    old_product_code = f"HR-{system_type_code}-{product_type}-{gate_type}-{old_size}"
                                                    new_product_code = f"HR-{system_type_code}-{product_type}-{gate_type}-{new_key}"
                                                    
                                                    st.info(f"ğŸ¯ ì œí’ˆ ì½”ë“œ ë³€í™˜: {old_product_code} â†’ {new_product_code}")
                                                    
                                                    # ê¸°ì¡´ ì œí’ˆ ì¡°íšŒ
                                                    import sqlite3
                                                    conn = sqlite3.connect(master_manager.db_path)
                                                    cursor = conn.cursor()
                                                    
                                                    cursor.execute("SELECT * FROM master_products WHERE product_code = ?", (old_product_code,))
                                                    existing_product = cursor.fetchone()
                                                    
                                                    if existing_product:
                                                        st.info(f"âœ… ê¸°ì¡´ ì œí’ˆ ë°œê²¬: {old_product_code}")
                                                        
                                                        # ìƒˆë¡œìš´ ì œí’ˆëª… ìƒì„±
                                                        korean_base = "í•«ëŸ¬ë„ˆ ë°¸ë¸Œ" if system_type == "Valve" else f"í•«ëŸ¬ë„ˆ {system_type}"
                                                        new_korean_name = f"{korean_base} {product_type} {gate_type} {new_key}mm"
                                                        new_english_name = f"Hot Runner {system_type} {product_type} {gate_type} {new_key}mm"
                                                        
                                                        # ì œí’ˆ ì •ë³´ ì—…ë°ì´íŠ¸
                                                        cursor.execute('''
                                                            UPDATE master_products 
                                                            SET product_code = ?, product_name = ?, product_name_en = ?, product_name_vi = ?, updated_date = datetime('now')
                                                            WHERE product_code = ?
                                                        ''', (new_product_code, new_korean_name, new_english_name, new_english_name, old_product_code))
                                                        
                                                        updated_count = cursor.rowcount
                                                        conn.commit()
                                                        conn.close()
                                                        
                                                        if updated_count > 0:
                                                            st.success(f"ğŸ¯ **ì œí’ˆ ìë™ ì—…ë°ì´íŠ¸ ì™„ë£Œ!** `{old_product_code}` â†’ `{new_product_code}`")
                                                        else:
                                                            st.warning(f"âš ï¸ ì œí’ˆ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: {old_product_code}")
                                                    else:
                                                        st.warning(f"âš ï¸ ê¸°ì¡´ ì œí’ˆì„ ì°¾ì„ ìˆ˜ ì—†ìŒ: {old_product_code}")
                                                        conn.close()
                                                else:
                                                    st.error(f"âŒ Parent Key í˜•ì‹ ì˜¤ë¥˜: {parent_key}")
                                                        
                                            except Exception as e:
                                                st.error(f"âŒ ì œí’ˆ ìë™ ì—…ë°ì´íŠ¸ ì˜¤ë¥˜: {str(e)}")
                                                import traceback
                                                st.code(traceback.format_exc())
                                        
                                        del st.session_state[f"editing_sz_{sz['component_id']}"]
                                        st.rerun()
                                    else:
                                        st.error("ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                            with col_cancel:
                                if st.form_submit_button("âŒ ì·¨ì†Œ"):
                                    del st.session_state[f"editing_sz_{sz['component_id']}"]
                                    st.rerun()
        
        else:
            st.info(f"ğŸ” {selected_system}-{selected_product}-{selected_gate}ì— ë“±ë¡ëœ ì‚¬ì´ì¦ˆê°€ ì—†ìŠµë‹ˆë‹¤.")
            st.markdown("ğŸ’¡ **ì•„ë˜ì—ì„œ ìƒˆ ì‚¬ì´ì¦ˆë¥¼ ì¶”ê°€í•˜ì„¸ìš”!**")
        
        # ìƒˆ Size ì¶”ê°€
        with st.expander(f"â• {selected_system}-{selected_product}-{selected_gate}ì— ìƒˆ ì‚¬ì´ì¦ˆ ì¶”ê°€"):
            with st.form(f"add_size_{parent_key}"):
                new_key = st.text_input("í‚¤", placeholder="ì˜ˆ: 20")
                new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: 20mm ì‚¬ì´ì¦ˆ")
                
                if st.form_submit_button("â• ì‚¬ì´ì¦ˆ ì¶”ê°€"):
                    if new_key:
                        success = config_manager.add_hr_component(
                            'size', parent_key, new_key, new_key, 
                            None, None, new_description
                        )
                        if success:
                            st.success(f"ì‚¬ì´ì¦ˆ '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                            
                            # ì œí’ˆ ì½”ë“œ ìë™ ìƒì„± ë° ë“±ë¡
                            try:
                                # parent_keyì—ì„œ System Type, Product Type, Gate Type ì¶”ì¶œ
                                parts = parent_key.split('-')
                                if len(parts) == 3:
                                    system_type, product_type, gate_type = parts
                                    
                                    # System Type ì½”ë“œ ë³€í™˜
                                    system_type_code = ""
                                    if system_type == "Valve":
                                        system_type_code = "VV"
                                    elif system_type == "Open":
                                        system_type_code = "OP"
                                    else:
                                        system_type_code = system_type[:2].upper()
                                    
                                    # ì œí’ˆ ì½”ë“œ ìƒì„±
                                    generated_code = f"HR-{system_type_code}-{product_type}-{gate_type}-{new_key}"
                                    
                                    # master_productsì— ìë™ ë“±ë¡
                                    from managers.sqlite.sqlite_master_product_manager import SQLiteMasterProductManager
                                    master_manager = SQLiteMasterProductManager()
                                    
                                    # ì¤‘ë³µ ì²´í¬
                                    existing_product = master_manager.get_product_by_code(generated_code)
                                    if not existing_product:
                                        import uuid
                                        import time
                                        timestamp = str(int(time.time()))[-6:]
                                        product_count = str(len(master_manager.get_all_products()) + 1).zfill(3)
                                        master_product_id = f"MP-HR-{timestamp}-{product_count}"
                                        
                                        # ê¸°ë³¸ ì œí’ˆëª… ìƒì„±
                                        korean_base = "í•«ëŸ¬ë„ˆ ë°¸ë¸Œ" if system_type == "Valve" else f"í•«ëŸ¬ë„ˆ {system_type}"
                                        default_korean = f"{korean_base} {product_type} {gate_type} {new_key}mm"
                                        default_english = f"Hot Runner {system_type} {product_type} {gate_type} {new_key}mm"
                                        
                                        product_data = {
                                            'master_product_id': master_product_id,
                                            'product_code': generated_code,
                                            'product_name': default_korean,
                                            'product_name_en': default_english,
                                            'product_name_vi': default_english,
                                            'category_name': 'HR',
                                            'subcategory_name': product_type,
                                            'supplier_name': '',
                                            'specifications': 'H30,34,1.0',
                                            'unit': 'EA',
                                            'status': 'active'
                                        }
                                        
                                        result = master_manager.add_master_product(product_data)
                                        if result:
                                            st.success(f"ğŸ¯ **ì œí’ˆ ì½”ë“œ ìë™ ìƒì„±:** `{generated_code}`")
                                            st.info("ğŸ“‹ HR ì¹´í…Œê³ ë¦¬ ëª©ë¡ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
                                        else:
                                            st.warning(f"âš ï¸ ì‚¬ì´ì¦ˆëŠ” ì¶”ê°€ë˜ì—ˆì§€ë§Œ ì œí’ˆ ì½”ë“œ ìƒì„± ì‹¤íŒ¨: `{generated_code}`")
                                    else:
                                        st.info(f"â„¹ï¸ ì œí’ˆ ì½”ë“œ `{generated_code}`ëŠ” ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤.")
                                        
                            except Exception as e:
                                st.warning(f"âš ï¸ ì‚¬ì´ì¦ˆëŠ” ì¶”ê°€ë˜ì—ˆì§€ë§Œ ì œí’ˆ ì½”ë“œ ìë™ ìƒì„± ì¤‘ ì˜¤ë¥˜: {e}")
                            
                            st.rerun()
                        else:
                            st.error("ì‚¬ì´ì¦ˆ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                    else:
                        st.warning("í‚¤ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.")


def show_robot_subcategories(config_manager):
    """ROBOT ì œí’ˆ ì½”ë“œ êµ¬ì„± ìš”ì†Œ ê´€ë¦¬"""
    st.subheader("ğŸ¤– ROBOT ì œí’ˆ ì½”ë“œ êµ¬ì„± ê´€ë¦¬")
    st.caption("Robot ì¹´í…Œê³ ë¦¬ì˜ Application Type, í˜ì´ë¡œë“œ, ë¦¬ì¹˜, ì¶• ìˆ˜ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤")
    
    # Robot êµ¬ì„± ìš”ì†Œ ê´€ë¦¬ íƒ­
    robot_tabs = st.tabs([
        "ğŸ¯ Application Type", 
        "ğŸ‹ï¸ í˜ì´ë¡œë“œ ë²”ìœ„", 
        "ğŸ“ ë¦¬ì¹˜ ë²”ìœ„", 
        "ğŸ”§ ì¶• ìˆ˜"
    ])
    
    with robot_tabs[0]:
        manage_robot_applications(config_manager)
    
    with robot_tabs[1]:
        manage_robot_payloads(config_manager)
    
    with robot_tabs[2]:
        manage_robot_reaches(config_manager)
    
    with robot_tabs[3]:
        manage_robot_axes(config_manager)

def manage_robot_applications(config_manager):
    """Robot Application Type ê´€ë¦¬"""
    st.subheader("ğŸ¯ Application Type ê´€ë¦¬")
    
    # í˜„ì¬ Application Type ëª©ë¡ í‘œì‹œ
    app_types = config_manager.get_hr_components_for_management('robot_application')
    
    if app_types:
        st.write("**í˜„ì¬ Application Types:**")
        for app_type in app_types:
            if app_type['is_active']:
                col1, col2, col3 = st.columns([6, 1, 1])
                with col1:
                    st.write(f"**{app_type['component_key']}** - {app_type['component_name']}")
                    if app_type['description']:
                        st.caption(app_type['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_app_{app_type['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_app_{app_type['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_app_{app_type['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(app_type['component_id']):
                            st.success("Application Typeì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                
                # ìˆ˜ì • í¼ í‘œì‹œ
                if st.session_state.get(f"editing_app_{app_type['component_id']}", False):
                    with st.expander("âœï¸ Application Type ìˆ˜ì •", expanded=True):
                        with st.form(f"edit_app_type_{app_type['component_id']}"):
                            new_key = st.text_input("í‚¤", value=app_type['component_key'])
                            new_description = st.text_input("ì„¤ëª…", value=app_type['description'] or "")
                            
                            col_submit, col_cancel = st.columns([1, 1])
                            with col_submit:
                                if st.form_submit_button("ğŸ’¾ ì €ì¥"):
                                    if config_manager.update_hr_component(
                                        app_type['component_id'], component_key=new_key, 
                                        component_name=new_key, description=new_description
                                    ):
                                        st.success("Application Typeì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                        del st.session_state[f"editing_app_{app_type['component_id']}"]
                                        st.rerun()
                                    else:
                                        st.error("ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                            with col_cancel:
                                if st.form_submit_button("âŒ ì·¨ì†Œ"):
                                    del st.session_state[f"editing_app_{app_type['component_id']}"]
                                    st.rerun()
    else:
        st.info("ë“±ë¡ëœ Application Typeì´ ì—†ìŠµë‹ˆë‹¤.")
    
    # ìƒˆ Application Type ì¶”ê°€
    with st.expander("â• ìƒˆ Application Type ì¶”ê°€"):
        with st.form("add_robot_application"):
            new_key = st.text_input("í‚¤", placeholder="ì˜ˆ: INJECTION")
            new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: ì‚¬ì¶œ ì„±í˜•ìš© ë¡œë´‡")
            
            if st.form_submit_button("â• Application Type ì¶”ê°€"):
                if new_key:
                    success = config_manager.add_hr_component(
                        'robot_application', 'ROBOT', new_key, new_key, None, None, new_description
                    )
                    if success:
                        st.success(f"Application Type '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                        st.rerun()
                    else:
                        st.error("Application Type ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                else:
                    st.warning("í‚¤ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.")

def manage_robot_payloads(config_manager):
    """Robot í˜ì´ë¡œë“œ ê´€ë¦¬"""
    st.subheader("ğŸ‹ï¸ í˜ì´ë¡œë“œ ë²”ìœ„ ê´€ë¦¬")
    st.caption("ë¡œë´‡ì˜ ìµœëŒ€ í˜ì´ë¡œë“œ ìš©ëŸ‰ ë²”ìœ„ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤ (kg ë‹¨ìœ„)")
    
    # í˜„ì¬ í˜ì´ë¡œë“œ ë²”ìœ„ ëª©ë¡ í‘œì‹œ
    payloads = config_manager.get_hr_components_for_management('robot_payload')
    
    if payloads:
        st.write("**í˜„ì¬ í˜ì´ë¡œë“œ ë²”ìœ„:**")
        for payload in payloads:
            if payload['is_active']:
                col1, col2, col3 = st.columns([6, 1, 1])
                with col1:
                    st.write(f"**{payload['component_key']}kg** - {payload['component_name']}")
                    if payload['description']:
                        st.caption(payload['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_payload_{payload['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_payload_{payload['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_payload_{payload['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(payload['component_id']):
                            st.success("í˜ì´ë¡œë“œê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
    else:
        st.info("ë“±ë¡ëœ í˜ì´ë¡œë“œ ë²”ìœ„ê°€ ì—†ìŠµë‹ˆë‹¤.")
    
    # ìƒˆ í˜ì´ë¡œë“œ ì¶”ê°€
    with st.expander("â• ìƒˆ í˜ì´ë¡œë“œ ë²”ìœ„ ì¶”ê°€"):
        with st.form("add_robot_payload"):
            new_key = st.text_input("í˜ì´ë¡œë“œ(kg)", placeholder="ì˜ˆ: 6")
            new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: 6kgê¹Œì§€ ì²˜ë¦¬ ê°€ëŠ¥")
            
            if st.form_submit_button("â• í˜ì´ë¡œë“œ ì¶”ê°€"):
                if new_key:
                    success = config_manager.add_hr_component(
                        'robot_payload', 'ROBOT', new_key, f"{new_key}kg", None, None, new_description
                    )
                    if success:
                        st.success(f"í˜ì´ë¡œë“œ '{new_key}kg'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                        st.rerun()
                    else:
                        st.error("í˜ì´ë¡œë“œ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                else:
                    st.warning("í˜ì´ë¡œë“œëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.")

def manage_robot_reaches(config_manager):
    """Robot ë¦¬ì¹˜ ê´€ë¦¬"""
    st.subheader("ğŸ“ ë¦¬ì¹˜ ë²”ìœ„ ê´€ë¦¬")
    st.caption("ë¡œë´‡ì˜ ìµœëŒ€ ë„ë‹¬ ê±°ë¦¬ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤ (mm ë‹¨ìœ„)")
    
    # í˜„ì¬ ë¦¬ì¹˜ ëª©ë¡ í‘œì‹œ
    reaches = config_manager.get_hr_components_for_management('robot_reach')
    
    if reaches:
        st.write("**í˜„ì¬ ë¦¬ì¹˜ ë²”ìœ„:**")
        for reach in reaches:
            if reach['is_active']:
                col1, col2, col3 = st.columns([6, 1, 1])
                with col1:
                    st.write(f"**{reach['component_key']}mm** - {reach['component_name']}")
                    if reach['description']:
                        st.caption(reach['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_reach_{reach['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_reach_{reach['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_reach_{reach['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(reach['component_id']):
                            st.success("ë¦¬ì¹˜ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
    else:
        st.info("ë“±ë¡ëœ ë¦¬ì¹˜ ë²”ìœ„ê°€ ì—†ìŠµë‹ˆë‹¤.")
    
    # ìƒˆ ë¦¬ì¹˜ ì¶”ê°€
    with st.expander("â• ìƒˆ ë¦¬ì¹˜ ë²”ìœ„ ì¶”ê°€"):
        with st.form("add_robot_reach"):
            new_key = st.text_input("ë¦¬ì¹˜(mm)", placeholder="ì˜ˆ: 1400")
            new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: 1400mm ë„ë‹¬ ë²”ìœ„")
            
            if st.form_submit_button("â• ë¦¬ì¹˜ ì¶”ê°€"):
                if new_key:
                    success = config_manager.add_hr_component(
                        'robot_reach', 'ROBOT', new_key, f"{new_key}mm", None, None, new_description
                    )
                    if success:
                        st.success(f"ë¦¬ì¹˜ '{new_key}mm'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                        st.rerun()
                    else:
                        st.error("ë¦¬ì¹˜ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                else:
                    st.warning("ë¦¬ì¹˜ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.")

def manage_robot_axes(config_manager):
    """Robot ì¶• ìˆ˜ ê´€ë¦¬"""
    st.subheader("ğŸ”§ ì¶• ìˆ˜ ê´€ë¦¬")
    st.caption("ë¡œë´‡ì˜ ììœ ë„(ì¶• ìˆ˜)ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤")
    
    # í˜„ì¬ ì¶• ìˆ˜ ëª©ë¡ í‘œì‹œ
    axes = config_manager.get_hr_components_for_management('robot_axes')
    
    if axes:
        st.write("**í˜„ì¬ ì¶• ìˆ˜:**")
        for axis in axes:
            if axis['is_active']:
                col1, col2, col3 = st.columns([6, 1, 1])
                with col1:
                    st.write(f"**{axis['component_key']}ì¶•** - {axis['component_name']}")
                    if axis['description']:
                        st.caption(axis['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_axis_{axis['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_axis_{axis['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_axis_{axis['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(axis['component_id']):
                            st.success("ì¶• ìˆ˜ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
    else:
        st.info("ë“±ë¡ëœ ì¶• ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.")
    
    # ìƒˆ ì¶• ìˆ˜ ì¶”ê°€
    with st.expander("â• ìƒˆ ì¶• ìˆ˜ ì¶”ê°€"):
        with st.form("add_robot_axes"):
            new_key = st.text_input("ì¶• ìˆ˜", placeholder="ì˜ˆ: 6")
            new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: 6ì¶• ê´€ì ˆ ë¡œë´‡")
            
            if st.form_submit_button("â• ì¶• ìˆ˜ ì¶”ê°€"):
                if new_key:
                    success = config_manager.add_hr_component(
                        'robot_axes', 'ROBOT', new_key, f"{new_key}ì¶•", None, None, new_description
                    )
                    if success:
                        st.success(f"ì¶• ìˆ˜ '{new_key}ì¶•'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                        st.rerun()
                    else:
                        st.error("ì¶• ìˆ˜ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                else:
                    st.warning("ì¶• ìˆ˜ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.")

# ========== ROBOT HR ìŠ¤íƒ€ì¼ ê³„ì¸µì  ê´€ë¦¬ í•¨ìˆ˜ë“¤ ==========

def manage_robot_applications_hr_style(config_manager):
    """ROBOT Application ê´€ë¦¬ - HR System Typeê³¼ ë™ì¼í•œ ë°©ì‹"""
    st.subheader("ğŸ­ Application ê´€ë¦¬")
    st.caption("ROBOTì˜ ê¸°ë³¸ Applicationì„ ê´€ë¦¬í•©ë‹ˆë‹¤ (HR System Typeê³¼ ë™ì¼í•œ ë°©ì‹)")
    
    # í˜„ì¬ Application ëª©ë¡ í‘œì‹œ (HRê³¼ ë™ì¼í•œ UI)
    applications = config_manager.get_hr_components_for_management('robot_application')
    
    if applications:
        st.write("**í˜„ì¬ ROBOT Application:**")
        for app in applications:
            if app['is_active']:
                col1, col2, col3 = st.columns([6, 1, 1])
                with col1:
                    st.write(f"**{app['component_key']}** - {app['component_name']}")
                    if app['description']:
                        st.caption(app['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_robot_app_{app['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_robot_app_{app['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_robot_app_{app['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(app['component_id']):
                            st.success("Applicationì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                
                # ìˆ˜ì • í¼ í‘œì‹œ (HRê³¼ ë™ì¼)
                if st.session_state.get(f"editing_robot_app_{app['component_id']}", False):
                    with st.expander("âœï¸ Application ìˆ˜ì •", expanded=True):
                        with st.form(f"edit_robot_app_{app['component_id']}"):
                            new_key = st.text_input("í‚¤", value=app['component_key'])
                            new_name = st.text_input("ì´ë¦„", value=app['component_name'])
                            new_description = st.text_input("ì„¤ëª…", value=app['description'] or "")
                            
                            col_submit, col_cancel = st.columns([1, 1])
                            with col_submit:
                                if st.form_submit_button("ğŸ’¾ ì €ì¥"):
                                    if config_manager.update_hr_component(
                                        app['component_id'], component_key=new_key, 
                                        component_name=new_name, description=new_description
                                    ):
                                        st.success("Applicationì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                        st.session_state[f"editing_robot_app_{app['component_id']}"] = False
                                        st.rerun()
                            
                            with col_cancel:
                                if st.form_submit_button("âŒ ì·¨ì†Œ"):
                                    st.session_state[f"editing_robot_app_{app['component_id']}"] = False
                                    st.rerun()
    else:
        st.info("ë“±ë¡ëœ Applicationì´ ì—†ìŠµë‹ˆë‹¤.")
    
    # ìƒˆ Application ì¶”ê°€ (HRê³¼ ë™ì¼)
    with st.expander("â• ìƒˆ Application ì¶”ê°€"):
        with st.form("add_robot_application"):
            new_key = st.text_input("Application í‚¤", placeholder="ì˜ˆ: IND")
            new_name = st.text_input("Application ì´ë¦„", placeholder="ì˜ˆ: Industrial")
            new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: ì‚°ì—…ìš© ë¡œë´‡")
            
            if st.form_submit_button("â• Application ì¶”ê°€"):
                if new_key and new_name:
                    success = config_manager.add_hr_component(
                        'robot_application', 'ROBOT', new_key, new_name, None, None, new_description
                    )
                    if success:
                        st.success(f"Application '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                        st.rerun()
                    else:
                        st.error("Application ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                else:
                    st.warning("Application í‚¤ì™€ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")

def manage_robot_axes_hr_style(config_manager):
    """ROBOT ì¶• ìˆ˜ ê´€ë¦¬ - HR Product Typeê³¼ ë™ì¼í•œ ë°©ì‹"""
    st.subheader("ğŸ”— ì¶• ìˆ˜ ê´€ë¦¬")
    st.caption("ì„ íƒëœ Applicationì˜ ì¶• ìˆ˜ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤ (HRê³¼ ë™ì¼í•œ ë°©ì‹)")
    
    # Application ì„ íƒ (HRê³¼ ë™ì¼)
    applications = config_manager.get_robot_applications()
    
    if not applications:
        st.warning("ë¨¼ì € Applicationì„ ë“±ë¡í•´ì£¼ì„¸ìš”.")
        return
    
    selected_application = st.selectbox("Application ì„ íƒ", [""] + applications)
    
    if selected_application:
        # ì„ íƒëœ Applicationì˜ ì¶• ìˆ˜ ëª©ë¡ (HRê³¼ ë™ì¼í•œ êµ¬ì¡°)
        axes_list = config_manager.get_hr_components_for_management('robot_axes')
        filtered_axes = [ax for ax in axes_list if ax['parent_component'] == selected_application and ax['is_active']]
        
        if filtered_axes:
            st.write(f"**{selected_application}ì˜ ì¶• ìˆ˜:**")
            for ax in filtered_axes:
                col1, col2, col3 = st.columns([3, 1, 1])
                with col1:
                    st.write(f"â€¢ **{ax['component_key']}ì¶•** - {ax['component_name']}")
                    if ax['description']:
                        st.caption(ax['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_robot_ax_{ax['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_robot_ax_{ax['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_robot_ax_{ax['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(ax['component_id']):
                            st.success("ì¶• ìˆ˜ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                
                # ìˆ˜ì • í¼ í‘œì‹œ (HRê³¼ ë™ì¼)
                if st.session_state.get(f"editing_robot_ax_{ax['component_id']}", False):
                    with st.expander("âœï¸ ì¶• ìˆ˜ ìˆ˜ì •", expanded=True):
                        with st.form(f"edit_robot_axes_{ax['component_id']}"):
                            new_key = st.text_input("í‚¤", value=ax['component_key'])
                            new_name = st.text_input("ì´ë¦„", value=ax['component_name'])
                            new_description = st.text_input("ì„¤ëª…", value=ax['description'] or "")
                            
                            col_submit, col_cancel = st.columns([1, 1])
                            with col_submit:
                                if st.form_submit_button("ğŸ’¾ ì €ì¥"):
                                    if config_manager.update_hr_component(
                                        ax['component_id'], component_key=new_key, 
                                        component_name=new_name, description=new_description
                                    ):
                                        st.success("ì¶• ìˆ˜ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                        st.session_state[f"editing_robot_ax_{ax['component_id']}"] = False
                                        st.rerun()
                            
                            with col_cancel:
                                if st.form_submit_button("âŒ ì·¨ì†Œ"):
                                    st.session_state[f"editing_robot_ax_{ax['component_id']}"] = False
                                    st.rerun()
        else:
            st.info(f"{selected_application}ì— ë“±ë¡ëœ ì¶• ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.")
        
        # ìƒˆ ì¶• ìˆ˜ ì¶”ê°€ (HRê³¼ ë™ì¼)
        with st.expander(f"â• {selected_application} ì¶• ìˆ˜ ì¶”ê°€"):
            with st.form(f"add_robot_axes_{selected_application}"):
                new_key = st.text_input("ì¶• ìˆ˜", placeholder="ì˜ˆ: 6")
                new_name = st.text_input("ì¶• ìˆ˜ ì´ë¦„", placeholder="ì˜ˆ: 6ì¶• ê´€ì ˆ")
                new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: 6ììœ ë„ ê´€ì ˆ ë¡œë´‡")
                
                if st.form_submit_button("â• ì¶• ìˆ˜ ì¶”ê°€"):
                    if new_key and new_name:
                        success = config_manager.add_hr_component(
                            'robot_axes', 'ROBOT', new_key, new_name, selected_application, None, new_description
                        )
                        if success:
                            st.success(f"ì¶• ìˆ˜ '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                        else:
                            st.error("ì¶• ìˆ˜ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                    else:
                        st.warning("ì¶• ìˆ˜ í‚¤ì™€ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")

def manage_robot_payloads_hr_style(config_manager):
    """ROBOT Payload ê´€ë¦¬ - HR Gate Typeê³¼ ë™ì¼í•œ ë°©ì‹"""
    st.subheader("âš™ï¸ Payload ê´€ë¦¬")
    st.caption("ì„ íƒëœ Applicationê³¼ ì¶• ìˆ˜ì˜ Payloadë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤ (HRê³¼ ë™ì¼í•œ ë°©ì‹)")
    
    # Application ì„ íƒ
    applications = config_manager.get_robot_applications()
    if not applications:
        st.warning("ë¨¼ì € Applicationì„ ë“±ë¡í•´ì£¼ì„¸ìš”.")
        return
    
    selected_application = st.selectbox("Application ì„ íƒ", [""] + applications, key="payload_app")
    
    if selected_application:
        # ì¶• ìˆ˜ ì„ íƒ
        axes_list = config_manager.get_robot_axes(selected_application)
        if not axes_list:
            st.warning(f"{selected_application}ì— ì¶• ìˆ˜ë¥¼ ë¨¼ì € ë“±ë¡í•´ì£¼ì„¸ìš”.")
            return
        
        selected_axes = st.selectbox("ì¶• ìˆ˜ ì„ íƒ", [""] + axes_list, key="payload_axes")
        
        if selected_axes:
            # ì„ íƒëœ Application-ì¶•ìˆ˜ì˜ Payload ëª©ë¡
            payloads = config_manager.get_hr_components_for_management('robot_payload')
            filtered_payloads = [pl for pl in payloads 
                               if pl['parent_component'] == selected_application 
                               and pl['sub_component'] == selected_axes 
                               and pl['is_active']]
            
            if filtered_payloads:
                st.write(f"**{selected_application}-{selected_axes}ì¶•ì˜ Payload:**")
                for pl in filtered_payloads:
                    col1, col2, col3 = st.columns([3, 1, 1])
                    with col1:
                        st.write(f"â€¢ **{pl['component_key']}kg** - {pl['component_name']}")
                        if pl['description']:
                            st.caption(pl['description'])
                    with col2:
                        if st.button("âœï¸", key=f"edit_robot_pl_{pl['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                            st.session_state[f"editing_robot_pl_{pl['component_id']}"] = True
                            st.rerun()
                    with col3:
                        if st.button("ğŸ—‘ï¸", key=f"delete_robot_pl_{pl['component_id']}", help="ì‚­ì œ", use_container_width=True):
                            if config_manager.delete_hr_component(pl['component_id']):
                                st.success("Payloadê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                                st.rerun()
            else:
                st.info(f"{selected_application}-{selected_axes}ì¶•ì— ë“±ë¡ëœ Payloadê°€ ì—†ìŠµë‹ˆë‹¤.")
            
            # ìƒˆ Payload ì¶”ê°€
            with st.expander(f"â• {selected_application}-{selected_axes}ì¶• Payload ì¶”ê°€"):
                with st.form(f"add_robot_payload_{selected_application}_{selected_axes}"):
                    new_key = st.text_input("Payload(kg)", placeholder="ì˜ˆ: 10")
                    new_name = st.text_input("Payload ì´ë¦„", placeholder="ì˜ˆ: 10kg í˜ì´ë¡œë“œ")
                    new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: ìµœëŒ€ 10kgê¹Œì§€ ì²˜ë¦¬ ê°€ëŠ¥")
                    
                    if st.form_submit_button("â• Payload ì¶”ê°€"):
                        if new_key and new_name:
                            success = config_manager.add_hr_component(
                                'robot_payload', 'ROBOT', new_key, new_name, 
                                selected_application, selected_axes, new_description
                            )
                            if success:
                                st.success(f"Payload '{new_key}kg'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                st.rerun()
                            else:
                                st.error("Payload ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                        else:
                            st.warning("Payload í‚¤ì™€ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")

def manage_robot_reaches_hr_style(config_manager):
    """ROBOT Reach ê´€ë¦¬ - HR Sizeì™€ ë™ì¼í•œ ë°©ì‹ (ìë™ ì œí’ˆ ìƒì„± í¬í•¨)"""
    st.subheader("ğŸ“ Reach ê´€ë¦¬")
    st.caption("ì„ íƒëœ Application, ì¶•ìˆ˜, Payloadì˜ Reachë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤ (HR Sizeì™€ ë™ì¼í•œ ë°©ì‹)")
    
    # Application ì„ íƒ
    applications = config_manager.get_robot_applications()
    if not applications:
        st.warning("ë¨¼ì € Applicationì„ ë“±ë¡í•´ì£¼ì„¸ìš”.")
        return
    
    selected_application = st.selectbox("Application ì„ íƒ", [""] + applications, key="reach_app")
    
    if selected_application:
        # ì¶• ìˆ˜ ì„ íƒ
        axes_list = config_manager.get_robot_axes(selected_application)
        if not axes_list:
            st.warning(f"{selected_application}ì— ì¶• ìˆ˜ë¥¼ ë¨¼ì € ë“±ë¡í•´ì£¼ì„¸ìš”.")
            return
        
        selected_axes = st.selectbox("ì¶• ìˆ˜ ì„ íƒ", [""] + axes_list, key="reach_axes")
        
        if selected_axes:
            # Payload ì„ íƒ
            payload_list = config_manager.get_robot_payloads(selected_application, selected_axes)
            if not payload_list:
                st.warning(f"{selected_application}-{selected_axes}ì¶•ì— Payloadë¥¼ ë¨¼ì € ë“±ë¡í•´ì£¼ì„¸ìš”.")
                return
            
            selected_payload = st.selectbox("Payload ì„ íƒ", [""] + payload_list, key="reach_payload")
            
            if selected_payload:
                # ì„ íƒëœ ì¡°í•©ì˜ Reach ëª©ë¡
                reaches = config_manager.get_hr_components_for_management('robot_reach')
                parent_key = f"{selected_application}-{selected_axes}-{selected_payload}"
                filtered_reaches = [r for r in reaches 
                                  if r['parent_component'] == parent_key 
                                  and r['is_active']]
                
                if filtered_reaches:
                    st.write(f"**{selected_application}-{selected_axes}ì¶•-{selected_payload}kgì˜ Reach:**")
                    for reach in filtered_reaches:
                        col1, col2, col3 = st.columns([3, 1, 1])
                        with col1:
                            st.write(f"â€¢ **{reach['component_key']}mm** - {reach['component_name']}")
                            if reach['description']:
                                st.caption(reach['description'])
                        with col2:
                            if st.button("âœï¸", key=f"edit_robot_reach_{reach['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                                st.session_state[f"editing_robot_reach_{reach['component_id']}"] = True
                                st.rerun()
                        with col3:
                            if st.button("ğŸ—‘ï¸", key=f"delete_robot_reach_{reach['component_id']}", help="ì‚­ì œ", use_container_width=True):
                                if config_manager.delete_hr_component(reach['component_id']):
                                    st.success("Reachê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                                    st.rerun()
                else:
                    st.info(f"{selected_application}-{selected_axes}ì¶•-{selected_payload}kgì— ë“±ë¡ëœ Reachê°€ ì—†ìŠµë‹ˆë‹¤.")
                
                # ìƒˆ Reach ì¶”ê°€ (HR Sizeì™€ ë™ì¼í•œ ë°©ì‹ - ìë™ ì œí’ˆ ìƒì„±)
                with st.expander(f"â• {selected_application}-{selected_axes}ì¶•-{selected_payload}kg Reach ì¶”ê°€"):
                    with st.form(f"add_robot_reach_{selected_application}_{selected_axes}_{selected_payload}"):
                        new_key = st.text_input("Reach(mm)", placeholder="ì˜ˆ: 1400")
                        new_name = st.text_input("Reach ì´ë¦„", placeholder="ì˜ˆ: 1400mm ë„ë‹¬")
                        new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: ìµœëŒ€ 1400mm ë„ë‹¬ ë²”ìœ„")
                        
                        if st.form_submit_button("â• Reach ì¶”ê°€"):
                            if new_key and new_name:
                                success = config_manager.add_hr_component(
                                    'robot_reach', 'ROBOT', new_key, new_name, 
                                    parent_key, None, new_description
                                )
                                if success:
                                    # ROBOT ìë™ ì œí’ˆ ìƒì„± (HRê³¼ ë™ì¼í•œ ë°©ì‹)
                                    product_created = config_manager.create_robot_product_for_reach(
                                        selected_application, selected_axes, selected_payload, new_key
                                    )
                                    
                                    if product_created:
                                        st.success(f"âœ… Reach '{new_key}mm'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤! (ì œí’ˆ ìë™ ìƒì„±)")
                                        st.info("ğŸ“‹ ROBOT ì¹´í…Œê³ ë¦¬ ëª©ë¡ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
                                    else:
                                        st.success(f"âœ… Reach '{new_key}mm'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                        st.warning("âš ï¸ ì œí’ˆ ìë™ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")
                                    st.rerun()
                                else:
                                    st.error("Reach ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                            else:
                                st.warning("Reach í‚¤ì™€ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")

def show_hrc_subcategories(config_manager):
    """Controller ì œí’ˆ ì½”ë“œ êµ¬ì„± ê´€ë¦¬ - HRê³¼ ë™ì¼í•œ êµ¬ì¡°"""
    st.subheader("âš™ï¸ Controller ì œí’ˆ ì½”ë“œ êµ¬ì„± ê´€ë¦¬")
    st.caption("Controller Type â†’ ì œí’ˆ íƒ€ì… â†’ ëª¨ë¸ íƒ€ì… â†’ ì¡´ ë²ˆí˜¸ (HRê³¼ ë™ì¼í•œ ê³„ì¸µí˜• ê´€ë¦¬)")
    
    # Controller êµ¬ì„± ê´€ë¦¬ íƒ­ (HRê³¼ ì™„ì „ ë™ì¼í•œ ê´€ë¦¬ ë°©ì‹)
    hrc_tabs = st.tabs([
        "ğŸ·ï¸ Controller Type ê´€ë¦¬",
        "ğŸ“ ì œí’ˆ íƒ€ì… ê´€ë¦¬",
        "ğŸ”§ ëª¨ë¸ íƒ€ì… ê´€ë¦¬", 
        "ğŸ“ ì¡´ ë²ˆí˜¸ ê´€ë¦¬"
    ])
    
    with hrc_tabs[0]:
        manage_hrc_types_hr_style(config_manager)
    
    with hrc_tabs[1]:
        manage_hrc_product_types_hr_style(config_manager)
    
    with hrc_tabs[2]:
        manage_hrc_model_types_hr_style(config_manager)
    
    with hrc_tabs[3]:
        manage_hrc_zones_hr_style(config_manager)

def manage_hrc_types_hr_style(config_manager):
    """Controller Type ê´€ë¦¬ - HR System Typeê³¼ ë™ì¼í•œ ë°©ì‹"""
    st.subheader("ğŸ·ï¸ Controller Type ê´€ë¦¬")
    st.caption("Controllerì˜ ê¸°ë³¸ íƒ€ì…ì„ ê´€ë¦¬í•©ë‹ˆë‹¤ (HR System Typeê³¼ ë™ì¼í•œ ë°©ì‹)")
    
    # í˜„ì¬ Controller Type ëª©ë¡ í‘œì‹œ (HRê³¼ ë™ì¼í•œ UI)
    hrc_types = config_manager.get_hr_components_for_management('hrc_type')
    
    if hrc_types:
        st.write("**í˜„ì¬ Controller Type:**")
        for hrc_type in hrc_types:
            if hrc_type['is_active']:
                col1, col2, col3 = st.columns([6, 1, 1])
                with col1:
                    st.write(f"**{hrc_type['component_key']}** - {hrc_type['component_name']}")
                    if hrc_type['description']:
                        st.caption(hrc_type['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_hrc_type_{hrc_type['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_hrc_type_{hrc_type['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_hrc_type_{hrc_type['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(hrc_type['component_id']):
                            st.success("Controller Typeì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                
                # ìˆ˜ì • í¼ í‘œì‹œ (HRê³¼ ë™ì¼)
                if st.session_state.get(f"editing_hrc_type_{hrc_type['component_id']}", False):
                    with st.expander("âœï¸ Controller Type ìˆ˜ì •", expanded=True):
                        with st.form(f"edit_hrc_type_{hrc_type['component_id']}"):
                            new_key = st.text_input("í‚¤", value=hrc_type['component_key'])
                            new_name = st.text_input("ì´ë¦„", value=hrc_type['component_name'])
                            new_description = st.text_input("ì„¤ëª…", value=hrc_type['description'] or "")
                            
                            col_submit, col_cancel = st.columns([1, 1])
                            with col_submit:
                                if st.form_submit_button("ğŸ’¾ ì €ì¥"):
                                    if config_manager.update_hr_component(
                                        hrc_type['component_id'], component_key=new_key, 
                                        component_name=new_name, description=new_description
                                    ):
                                        st.success("Controller Typeì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                        st.session_state[f"editing_hrc_type_{hrc_type['component_id']}"] = False
                                        st.rerun()
                            
                            with col_cancel:
                                if st.form_submit_button("âŒ ì·¨ì†Œ"):
                                    st.session_state[f"editing_hrc_type_{hrc_type['component_id']}"] = False
                                    st.rerun()
    else:
        st.info("ë“±ë¡ëœ Controller Typeì´ ì—†ìŠµë‹ˆë‹¤.")
    
    # ìƒˆ Controller Type ì¶”ê°€ (HRê³¼ ë™ì¼)
    with st.expander("â• ìƒˆ Controller Type ì¶”ê°€"):
        with st.form("add_hrc_type"):
            new_key = st.text_input("Controller Type í‚¤", placeholder="ì˜ˆ: HRCT")
            new_name = st.text_input("Controller Type ì´ë¦„", placeholder="ì˜ˆ: ì˜¨ë„ ì œì–´")
            new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: ì˜¨ë„ ì œì–´ê¸° íƒ€ì…")
            
            if st.form_submit_button("â• Controller Type ì¶”ê°€"):
                if new_key and new_name:
                    success = config_manager.add_hr_component(
                        'hrc_type', 'HRC', new_key, new_name, None, None, new_description
                    )
                    if success:
                        st.success(f"Controller Type '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                        st.rerun()
                    else:
                        st.error("Controller Type ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                else:
                    st.warning("Controller Type í‚¤ì™€ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")

def manage_hrc_product_types_hr_style(config_manager):
    """Controller ì œí’ˆ íƒ€ì… ê´€ë¦¬ - HR Product Typeê³¼ ë™ì¼í•œ ë°©ì‹"""
    st.subheader("ğŸ“ Controller ì œí’ˆ íƒ€ì… ê´€ë¦¬")
    st.caption("ì„ íƒëœ Controller Typeì˜ ì œí’ˆ íƒ€ì…ì„ ê´€ë¦¬í•©ë‹ˆë‹¤ (HRê³¼ ë™ì¼í•œ ë°©ì‹)")
    
    # Controller Type ì„ íƒ (HRê³¼ ë™ì¼)
    hrc_types = config_manager.get_hrc_types()
    
    if not hrc_types:
        st.warning("ë¨¼ì € Controller Typeì„ ë“±ë¡í•´ì£¼ì„¸ìš”.")
        return
    
    selected_hrc_type = st.selectbox("Controller Type ì„ íƒ", [""] + hrc_types)
    
    if selected_hrc_type:
        # ì„ íƒëœ HRC Typeì˜ ì œí’ˆ íƒ€ì… ëª©ë¡ (HRê³¼ ë™ì¼í•œ êµ¬ì¡°)
        product_types = config_manager.get_hr_components_for_management('hrc_product_type')
        filtered_types = [pt for pt in product_types if pt['parent_component'] == selected_hrc_type and pt['is_active']]
        
        if filtered_types:
            st.write(f"**{selected_hrc_type}ì˜ ì œí’ˆ íƒ€ì…:**")
            for pt in filtered_types:
                col1, col2, col3 = st.columns([3, 1, 1])
                with col1:
                    st.write(f"â€¢ **{pt['component_key']}** - {pt['component_name']}")
                    if pt['description']:
                        st.caption(pt['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_hrc_pt_{pt['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_hrc_pt_{pt['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_hrc_pt_{pt['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(pt['component_id']):
                            st.success("ì œí’ˆ íƒ€ì…ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                
                # ìˆ˜ì • í¼ í‘œì‹œ (HRê³¼ ë™ì¼)
                if st.session_state.get(f"editing_hrc_pt_{pt['component_id']}", False):
                    with st.expander("âœï¸ ì œí’ˆ íƒ€ì… ìˆ˜ì •", expanded=True):
                        with st.form(f"edit_hrc_product_type_{pt['component_id']}"):
                            new_key = st.text_input("í‚¤", value=pt['component_key'])
                            new_name = st.text_input("ì´ë¦„", value=pt['component_name'])
                            new_description = st.text_input("ì„¤ëª…", value=pt['description'] or "")
                            
                            col_submit, col_cancel = st.columns([1, 1])
                            with col_submit:
                                if st.form_submit_button("ğŸ’¾ ì €ì¥"):
                                    if config_manager.update_hr_component(
                                        pt['component_id'], component_key=new_key, 
                                        component_name=new_name, description=new_description
                                    ):
                                        st.success("ì œí’ˆ íƒ€ì…ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                        st.session_state[f"editing_hrc_pt_{pt['component_id']}"] = False
                                        st.rerun()
                            
                            with col_cancel:
                                if st.form_submit_button("âŒ ì·¨ì†Œ"):
                                    st.session_state[f"editing_hrc_pt_{pt['component_id']}"] = False
                                    st.rerun()
        else:
            st.info(f"{selected_hrc_type}ì— ë“±ë¡ëœ ì œí’ˆ íƒ€ì…ì´ ì—†ìŠµë‹ˆë‹¤.")
        
        # ìƒˆ ì œí’ˆ íƒ€ì… ì¶”ê°€ (HRê³¼ ë™ì¼)
        with st.expander(f"â• {selected_hrc_type} ì œí’ˆ íƒ€ì… ì¶”ê°€"):
            with st.form(f"add_hrc_product_type_{selected_hrc_type}"):
                new_key = st.text_input("ì œí’ˆ íƒ€ì… í‚¤", placeholder="ì˜ˆ: TEMP")
                new_name = st.text_input("ì œí’ˆ íƒ€ì… ì´ë¦„", placeholder="ì˜ˆ: ì˜¨ë„ ì œì–´")
                new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: ì˜¨ë„ ì œì–´ ì œí’ˆ íƒ€ì…")
                
                if st.form_submit_button("â• ì œí’ˆ íƒ€ì… ì¶”ê°€"):
                    if new_key and new_name:
                        success = config_manager.add_hr_component(
                            'hrc_product_type', 'HRC', new_key, new_name, selected_hrc_type, None, new_description
                        )
                        if success:
                            st.success(f"ì œí’ˆ íƒ€ì… '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                        else:
                            st.error("ì œí’ˆ íƒ€ì… ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                    else:
                        st.warning("ì œí’ˆ íƒ€ì… í‚¤ì™€ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")

def manage_hrc_model_types_hr_style(config_manager):
    """Controller ëª¨ë¸ íƒ€ì… ê´€ë¦¬ - HR Gate Typeê³¼ ë™ì¼í•œ ë°©ì‹"""
    st.subheader("ğŸ”§ Controller ëª¨ë¸ íƒ€ì… ê´€ë¦¬")
    st.caption("ì„ íƒëœ Controller Typeê³¼ ì œí’ˆ íƒ€ì…ì˜ ëª¨ë¸ íƒ€ì…ì„ ê´€ë¦¬í•©ë‹ˆë‹¤ (HRê³¼ ë™ì¼í•œ ë°©ì‹)")
    
    # Controller Type ì„ íƒ
    hrc_types = config_manager.get_hrc_types()
    if not hrc_types:
        st.warning("ë¨¼ì € Controller Typeì„ ë“±ë¡í•´ì£¼ì„¸ìš”.")
        return
    
    selected_hrc_type = st.selectbox("HRC Type ì„ íƒ", [""] + hrc_types, key="model_hrc_type")
    
    if selected_hrc_type:
        # ì œí’ˆ íƒ€ì… ì„ íƒ
        product_types = config_manager.get_hrc_product_types(selected_hrc_type)
        if not product_types:
            st.warning(f"{selected_hrc_type}ì— ì œí’ˆ íƒ€ì…ì„ ë¨¼ì € ë“±ë¡í•´ì£¼ì„¸ìš”.")
            return
        
        selected_product_type = st.selectbox("ì œí’ˆ íƒ€ì… ì„ íƒ", [""] + product_types, key="model_product_type")
        
        if selected_product_type:
            # ì„ íƒëœ HRC Type-ì œí’ˆíƒ€ì…ì˜ ëª¨ë¸ íƒ€ì… ëª©ë¡
            model_types = config_manager.get_hr_components_for_management('hrc_model_type')
            filtered_models = [mt for mt in model_types 
                             if mt['parent_component'] == selected_hrc_type 
                             and mt['sub_component'] == selected_product_type 
                             and mt['is_active']]
            
            if filtered_models:
                st.write(f"**{selected_hrc_type}-{selected_product_type}ì˜ ëª¨ë¸ íƒ€ì…:**")
                for mt in filtered_models:
                    col1, col2, col3 = st.columns([3, 1, 1])
                    with col1:
                        st.write(f"â€¢ **{mt['component_key']}** - {mt['component_name']}")
                        if mt['description']:
                            st.caption(mt['description'])
                    with col2:
                        if st.button("âœï¸", key=f"edit_hrc_mt_{mt['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                            st.session_state[f"editing_hrc_mt_{mt['component_id']}"] = True
                            st.rerun()
                    with col3:
                        if st.button("ğŸ—‘ï¸", key=f"delete_hrc_mt_{mt['component_id']}", help="ì‚­ì œ", use_container_width=True):
                            if config_manager.delete_hr_component(mt['component_id']):
                                st.success("ëª¨ë¸ íƒ€ì…ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                                st.rerun()
                    
                    # ìˆ˜ì • í¼ í‘œì‹œ
                    if st.session_state.get(f"editing_hrc_mt_{mt['component_id']}", False):
                        with st.expander("âœï¸ ëª¨ë¸ íƒ€ì… ìˆ˜ì •", expanded=True):
                            with st.form(f"edit_hrc_model_type_{mt['component_id']}"):
                                new_key = st.text_input("í‚¤", value=mt['component_key'])
                                new_name = st.text_input("ì´ë¦„", value=mt['component_name'])
                                new_description = st.text_input("ì„¤ëª…", value=mt['description'] or "")
                                
                                col_submit, col_cancel = st.columns([1, 1])
                                with col_submit:
                                    if st.form_submit_button("ğŸ’¾ ì €ì¥"):
                                        if config_manager.update_hr_component(
                                            mt['component_id'], component_key=new_key, 
                                            component_name=new_name, description=new_description
                                        ):
                                            st.success("ëª¨ë¸ íƒ€ì…ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                            st.session_state[f"editing_hrc_mt_{mt['component_id']}"] = False
                                            st.rerun()
                                
                                with col_cancel:
                                    if st.form_submit_button("âŒ ì·¨ì†Œ"):
                                        st.session_state[f"editing_hrc_mt_{mt['component_id']}"] = False
                                        st.rerun()
            else:
                st.info(f"{selected_hrc_type}-{selected_product_type}ì— ë“±ë¡ëœ ëª¨ë¸ íƒ€ì…ì´ ì—†ìŠµë‹ˆë‹¤.")
            
            # ìƒˆ ëª¨ë¸ íƒ€ì… ì¶”ê°€
            with st.expander(f"â• {selected_hrc_type}-{selected_product_type} ëª¨ë¸ íƒ€ì… ì¶”ê°€"):
                with st.form(f"add_hrc_model_type_{selected_hrc_type}_{selected_product_type}"):
                    new_key = st.text_input("ëª¨ë¸ íƒ€ì… í‚¤", placeholder="ì˜ˆ: YC60")
                    new_name = st.text_input("ëª¨ë¸ íƒ€ì… ì´ë¦„", placeholder="ì˜ˆ: YC60 ì»¨íŠ¸ë¡¤ëŸ¬")
                    new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: YC60 ì‹œë¦¬ì¦ˆ ì»¨íŠ¸ë¡¤ëŸ¬")
                    
                    submitted = st.form_submit_button("â• ëª¨ë¸ íƒ€ì… ì¶”ê°€")
                    
                    if submitted:
                        if new_key and new_name:
                            success = config_manager.add_hr_component(
                                'hrc_model_type', 'HRC', new_key, new_name, 
                                selected_hrc_type, selected_product_type, new_description
                            )
                            if success:
                                st.success(f"ëª¨ë¸ íƒ€ì… '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                # í¼ì´ ìë™ìœ¼ë¡œ ë¦¬ì…‹ë˜ë„ë¡ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
                                st.rerun()
                            else:
                                st.error("ëª¨ë¸ íƒ€ì… ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                        else:
                            st.warning("ëª¨ë¸ íƒ€ì… í‚¤ì™€ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")

def manage_hrc_zones_hr_style(config_manager):
    """Controller ì¡´ ë²ˆí˜¸ ê´€ë¦¬ - HR Sizeì™€ ë™ì¼í•œ ë°©ì‹"""
    st.subheader("ğŸ“ Controller ì¡´ ë²ˆí˜¸ ê´€ë¦¬")
    st.caption("Controller ê³µí†µ ì¡´ ë²ˆí˜¸ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤ (HR Sizeì™€ ë™ì¼í•œ ë°©ì‹)")
    
    # í˜„ì¬ ì¡´ ë²ˆí˜¸ ëª©ë¡ í‘œì‹œ
    zones = config_manager.get_hr_components_for_management('hrc_zone')
    
    if zones:
        st.write("**í˜„ì¬ Controller ì¡´ ë²ˆí˜¸:**")
        for zone in zones:
            if zone['is_active']:
                col1, col2, col3 = st.columns([6, 1, 1])
                with col1:
                    if zone['component_key'] == "Special":
                        st.write(f"ğŸ”§ **{zone['component_key']}** - {zone['component_name']} (ì§ì ‘ì…ë ¥)")
                    else:
                        st.write(f"ğŸ“ **Zone{zone['component_key']}** - {zone['component_name']}")
                    if zone['description']:
                        st.caption(zone['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_hrc_zone_{zone['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_hrc_zone_{zone['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_hrc_zone_{zone['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(zone['component_id']):
                            st.success("ì¡´ ë²ˆí˜¸ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                
                # ìˆ˜ì • í¼ í‘œì‹œ
                if st.session_state.get(f"editing_hrc_zone_{zone['component_id']}", False):
                    with st.expander("âœï¸ ì¡´ ë²ˆí˜¸ ìˆ˜ì •", expanded=True):
                        with st.form(f"edit_hrc_zone_{zone['component_id']}"):
                            new_key = st.text_input("í‚¤", value=zone['component_key'])
                            new_name = st.text_input("ì´ë¦„", value=zone['component_name'])
                            new_description = st.text_input("ì„¤ëª…", value=zone['description'] or "")
                            
                            col_submit, col_cancel = st.columns([1, 1])
                            with col_submit:
                                if st.form_submit_button("ğŸ’¾ ì €ì¥"):
                                    if config_manager.update_hr_component(
                                        zone['component_id'], component_key=new_key, 
                                        component_name=new_name, description=new_description
                                    ):
                                        st.success("ì¡´ ë²ˆí˜¸ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                        st.session_state[f"editing_hrc_zone_{zone['component_id']}"] = False
                                        st.rerun()
                            
                            with col_cancel:
                                if st.form_submit_button("âŒ ì·¨ì†Œ"):
                                    st.session_state[f"editing_hrc_zone_{zone['component_id']}"] = False
                                    st.rerun()
    else:
        st.info("ë“±ë¡ëœ ì¡´ ë²ˆí˜¸ê°€ ì—†ìŠµë‹ˆë‹¤.")
    
    # ìƒˆ ì¡´ ë²ˆí˜¸ ì¶”ê°€
    with st.expander("â• ìƒˆ ì¡´ ë²ˆí˜¸ ì¶”ê°€"):
        with st.form("add_hrc_zone"):
            col1, col2 = st.columns(2)
            with col1:
                new_key = st.text_input("ì¡´ ë²ˆí˜¸", placeholder="ì˜ˆ: 1, 4, 6, 8, Special")
                new_name = st.text_input("ì´ë¦„", placeholder="ì˜ˆ: Zone 1, Zone 4, íŠ¹ë³„ ì¡´")
            with col2:
                new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: í‘œì¤€ 1ì¡´, íŠ¹ë³„ ìš©ë„ ì¡´")
            
            if st.form_submit_button("â• ì¡´ ë²ˆí˜¸ ì¶”ê°€"):
                if new_key and new_name:
                    success = config_manager.add_hr_component(
                        'hrc_zone', 'HRC', new_key, new_name, None, None, new_description
                    )
                    if success:
                        # HRC ìë™ ì œí’ˆ ìƒì„± (HRê³¼ ë™ì¼í•œ ë°©ì‹)
                        products_created = config_manager.create_hrc_products_for_zone(new_key)
                        
                        if products_created > 0:
                            st.success(f"âœ… ì¡´ ë²ˆí˜¸ '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤! ({products_created}ê°œ ì œí’ˆ ìë™ ìƒì„±)")
                        else:
                            st.success(f"âœ… ì¡´ ë²ˆí˜¸ '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.info("ğŸ’¡ Controller Type, ì œí’ˆ íƒ€ì…, ëª¨ë¸ì„ ë¨¼ì € ë“±ë¡í•˜ë©´ ì œí’ˆì´ ìë™ ìƒì„±ë©ë‹ˆë‹¤.")
                        st.rerun()
                    else:
                        st.error("ì¡´ ë²ˆí˜¸ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                else:
                    st.warning("ì¡´ ë²ˆí˜¸ì™€ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")

def manage_hrct_categories(config_manager):
    """HRCT ì¹´í…Œê³ ë¦¬ ê´€ë¦¬"""
    st.subheader("ğŸŒ¡ï¸ HRCT ì¹´í…Œê³ ë¦¬ ê´€ë¦¬")
    st.caption("HRCT ì˜¨ë„ì œì–´ê¸°ì˜ ì¹´í…Œê³ ë¦¬ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤")
    
    # í˜„ì¬ HRCT ì¹´í…Œê³ ë¦¬ ëª©ë¡ í‘œì‹œ
    hrct_categories = config_manager.get_hr_components_for_management('hrct_category')
    
    if hrct_categories:
        st.write("**í˜„ì¬ HRCT ì¹´í…Œê³ ë¦¬:**")
        for category in hrct_categories:
            if category['is_active']:
                col1, col2, col3 = st.columns([6, 1, 1])
                with col1:
                    st.write(f"**{category['component_key']}** - {category['component_name']}")
                    if category['description']:
                        st.caption(category['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_hrct_cat_{category['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_hrct_cat_{category['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_hrct_cat_{category['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(category['component_id']):
                            st.success("HRCT ì¹´í…Œê³ ë¦¬ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
    else:
        st.info("ë“±ë¡ëœ HRCT ì¹´í…Œê³ ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤.")
    
    # ìƒˆ HRCT ì¹´í…Œê³ ë¦¬ ì¶”ê°€
    with st.expander("â• ìƒˆ HRCT ì¹´í…Œê³ ë¦¬ ì¶”ê°€"):
        with st.form("add_hrct_category"):
            new_key = st.text_input("ì¹´í…Œê³ ë¦¬ í‚¤", placeholder="ì˜ˆ: TEMP")
            new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: ì˜¨ë„ ì œì–´")
            
            if st.form_submit_button("â• HRCT ì¹´í…Œê³ ë¦¬ ì¶”ê°€"):
                if new_key:
                    success = config_manager.add_hr_component(
                        'hrct_category', 'HRCT', new_key, new_key, None, None, new_description
                    )
                    if success:
                        st.success(f"HRCT ì¹´í…Œê³ ë¦¬ '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                        st.rerun()
                    else:
                        st.error("HRCT ì¹´í…Œê³ ë¦¬ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                else:
                    st.warning("ì¹´í…Œê³ ë¦¬ í‚¤ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.")

def manage_hrcs_categories(config_manager):
    """HRCS ì¹´í…Œê³ ë¦¬ ê´€ë¦¬"""
    st.subheader("â±ï¸ HRCS ì¹´í…Œê³ ë¦¬ ê´€ë¦¬")
    st.caption("HRCS ì‹œê°„ì œì–´ê¸°ì˜ ì¹´í…Œê³ ë¦¬ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤")
    
    # í˜„ì¬ HRCS ì¹´í…Œê³ ë¦¬ ëª©ë¡ í‘œì‹œ
    hrcs_categories = config_manager.get_hr_components_for_management('hrcs_category')
    
    if hrcs_categories:
        st.write("**í˜„ì¬ HRCS ì¹´í…Œê³ ë¦¬:**")
        for category in hrcs_categories:
            if category['is_active']:
                col1, col2, col3 = st.columns([6, 1, 1])
                with col1:
                    st.write(f"**{category['component_key']}** - {category['component_name']}")
                    if category['description']:
                        st.caption(category['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_hrcs_cat_{category['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_hrcs_cat_{category['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_hrcs_cat_{category['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(category['component_id']):
                            st.success("HRCS ì¹´í…Œê³ ë¦¬ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
    else:
        st.info("ë“±ë¡ëœ HRCS ì¹´í…Œê³ ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤.")
    
    # ìƒˆ HRCS ì¹´í…Œê³ ë¦¬ ì¶”ê°€
    with st.expander("â• ìƒˆ HRCS ì¹´í…Œê³ ë¦¬ ì¶”ê°€"):
        with st.form("add_hrcs_category"):
            new_key = st.text_input("ì¹´í…Œê³ ë¦¬ í‚¤", placeholder="ì˜ˆ: TIMER")
            new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: íƒ€ì´ë¨¸ ì œì–´")
            
            if st.form_submit_button("â• HRCS ì¹´í…Œê³ ë¦¬ ì¶”ê°€"):
                if new_key:
                    success = config_manager.add_hr_component(
                        'hrcs_category', 'HRCS', new_key, new_key, None, None, new_description
                    )
                    if success:
                        st.success(f"HRCS ì¹´í…Œê³ ë¦¬ '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                        st.rerun()
                    else:
                        st.error("HRCS ì¹´í…Œê³ ë¦¬ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                else:
                    st.warning("ì¹´í…Œê³ ë¦¬ í‚¤ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.")

def manage_hrct_models(config_manager):
    """HRCT ëª¨ë¸ ê´€ë¦¬"""
    st.subheader("ğŸ”§ HRCT ëª¨ë¸ ê´€ë¦¬")
    st.caption("HRCT ì˜¨ë„ì œì–´ê¸°ì˜ ëª¨ë¸ì„ ê´€ë¦¬í•©ë‹ˆë‹¤")
    
    # ì¹´í…Œê³ ë¦¬ ì„ íƒ
    hrct_categories = config_manager.get_hrct_categories()
    if not hrct_categories:
        st.warning("ë¨¼ì € HRCT ì¹´í…Œê³ ë¦¬ë¥¼ ë“±ë¡í•´ì£¼ì„¸ìš”.")
        return
    
    selected_category = st.selectbox("HRCT ì¹´í…Œê³ ë¦¬ ì„ íƒ", [""] + hrct_categories)
    
    if selected_category:
        # ì„ íƒëœ ì¹´í…Œê³ ë¦¬ì˜ ëª¨ë¸ ëª©ë¡
        models = config_manager.get_hr_components_for_management('hrct_model')
        filtered_models = [m for m in models if m['parent_component'] == selected_category and m['is_active']]
        
        if filtered_models:
            st.write(f"**{selected_category}ì˜ ëª¨ë¸:**")
            for model in filtered_models:
                col1, col2, col3 = st.columns([6, 1, 1])
                with col1:
                    st.write(f"â€¢ **{model['component_key']}** - {model['component_name']}")
                with col2:
                    if st.button("âœï¸", key=f"edit_hrct_model_{model['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_hrct_model_{model['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_hrct_model_{model['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(model['component_id']):
                            st.success("HRCT ëª¨ë¸ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
        
        # ìƒˆ ëª¨ë¸ ì¶”ê°€
        with st.expander(f"â• {selected_category} ëª¨ë¸ ì¶”ê°€"):
            with st.form(f"add_hrct_model_{selected_category}"):
                new_key = st.text_input("ëª¨ë¸ í‚¤", placeholder="ì˜ˆ: YC60")
                new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: YC60 ì˜¨ë„ì œì–´ê¸°")
                
                if st.form_submit_button("â• HRCT ëª¨ë¸ ì¶”ê°€"):
                    if new_key:
                        success = config_manager.add_hr_component(
                            'hrct_model', selected_category, new_key, new_key, None, None, new_description
                        )
                        if success:
                            st.success(f"HRCT ëª¨ë¸ '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                        else:
                            st.error("HRCT ëª¨ë¸ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                    else:
                        st.warning("ëª¨ë¸ í‚¤ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.")

def manage_hrcs_models(config_manager):
    """HRCS ëª¨ë¸ ê´€ë¦¬"""
    st.subheader("âš™ï¸ HRCS ëª¨ë¸ ê´€ë¦¬")
    st.caption("HRCS ì‹œê°„ì œì–´ê¸°ì˜ ëª¨ë¸ì„ ê´€ë¦¬í•©ë‹ˆë‹¤")
    
    # ì¹´í…Œê³ ë¦¬ ì„ íƒ
    hrcs_categories = config_manager.get_hrcs_categories()
    if not hrcs_categories:
        st.warning("ë¨¼ì € HRCS ì¹´í…Œê³ ë¦¬ë¥¼ ë“±ë¡í•´ì£¼ì„¸ìš”.")
        return
    
    selected_category = st.selectbox("HRCS ì¹´í…Œê³ ë¦¬ ì„ íƒ", [""] + hrcs_categories)
    
    if selected_category:
        # ì„ íƒëœ ì¹´í…Œê³ ë¦¬ì˜ ëª¨ë¸ ëª©ë¡
        models = config_manager.get_hr_components_for_management('hrcs_model')
        filtered_models = [m for m in models if m['parent_component'] == selected_category and m['is_active']]
        
        if filtered_models:
            st.write(f"**{selected_category}ì˜ ëª¨ë¸:**")
            for model in filtered_models:
                col1, col2, col3 = st.columns([6, 1, 1])
                with col1:
                    st.write(f"â€¢ **{model['component_key']}** - {model['component_name']}")
                with col2:
                    if st.button("âœï¸", key=f"edit_hrcs_model_{model['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_hrcs_model_{model['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_hrcs_model_{model['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(model['component_id']):
                            st.success("HRCS ëª¨ë¸ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
        
        # ìƒˆ ëª¨ë¸ ì¶”ê°€
        with st.expander(f"â• {selected_category} ëª¨ë¸ ì¶”ê°€"):
            with st.form(f"add_hrcs_model_{selected_category}"):
                new_key = st.text_input("ëª¨ë¸ í‚¤", placeholder="ì˜ˆ: YC60T")
                new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: YC60T íƒ€ì´ë¨¸ì œì–´ê¸°")
                
                if st.form_submit_button("â• HRCS ëª¨ë¸ ì¶”ê°€"):
                    if new_key:
                        success = config_manager.add_hr_component(
                            'hrcs_model', selected_category, new_key, new_key, None, None, new_description
                        )
                        if success:
                            st.success(f"HRCS ëª¨ë¸ '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                        else:
                            st.error("HRCS ëª¨ë¸ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                    else:
                        st.warning("ëª¨ë¸ í‚¤ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.")

def manage_hrc_zones(config_manager):
    """Controller ì¡´ ë²ˆí˜¸ ê´€ë¦¬ (HRCT, HRCS ê³µí†µ)"""
    st.subheader("ğŸ“‹ Controller ì¡´ ë²ˆí˜¸ ê´€ë¦¬")
    st.caption("HRCT, HRCS ê³µí†µìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ì¡´ ë²ˆí˜¸ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤")
    
    # í˜„ì¬ ì¡´ ë²ˆí˜¸ ëª©ë¡ í‘œì‹œ
    zones = config_manager.get_hr_components_for_management('hrc_zone')
    
    if zones:
        st.write("**í˜„ì¬ Controller ì¡´ ë²ˆí˜¸:**")
        cols = st.columns(4)
        for i, zone in enumerate(zones):
            if zone['is_active']:
                with cols[i % 4]:
                    col1, col2 = st.columns([3, 1])
                    with col1:
                        st.write(f"**{zone['component_key']}**")
                    with col2:
                        if st.button("ğŸ—‘ï¸", key=f"delete_zone_{zone['component_id']}", help="ì‚­ì œ", use_container_width=True):
                            if config_manager.delete_hr_component(zone['component_id']):
                                st.success("ì¡´ ë²ˆí˜¸ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                                st.rerun()
    else:
        st.info("ë“±ë¡ëœ ì¡´ ë²ˆí˜¸ê°€ ì—†ìŠµë‹ˆë‹¤.")
    
    # ìƒˆ ì¡´ ë²ˆí˜¸ ì¶”ê°€
    with st.expander("â• ìƒˆ ì¡´ ë²ˆí˜¸ ì¶”ê°€"):
        with st.form("add_hrc_zone"):
            col1, col2 = st.columns(2)
            with col1:
                new_key = st.text_input("ì¡´ ë²ˆí˜¸", placeholder="ì˜ˆ: 50")
                new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: 50ì¡´ ì»¨íŠ¸ë¡¤ëŸ¬")
            with col2:
                st.info("**ê¸°ë³¸ ì¡´ ë²ˆí˜¸:** 1, 4, 6, 8, 12, 18, 24, 30, 32, 36, 40, 42, 48, Special")
            
            if st.form_submit_button("â• ì¡´ ë²ˆí˜¸ ì¶”ê°€"):
                if new_key:
                    success = config_manager.add_hr_component(
                        'hrc_zone', 'HRC', new_key, new_key, None, None, new_description
                    )
                    if success:
                        st.success(f"ì¡´ ë²ˆí˜¸ '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                        st.rerun()
                    else:
                        st.error("ì¡´ ë²ˆí˜¸ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                else:
                    st.warning("ì¡´ ë²ˆí˜¸ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.")

def show_mb_subcategories_hr_style(config_manager):
    """MB ì œí’ˆ ì½”ë“œ êµ¬ì„± ê´€ë¦¬ - Controllerì™€ ë™ì¼í•œ êµ¬ì¡°"""
    st.subheader("ğŸ”§ MB ì œí’ˆ ì½”ë“œ êµ¬ì„± ê´€ë¦¬")
    st.caption("MB Type â†’ Sub Category â†’ Material (Controllerì™€ ë™ì¼í•œ ê³„ì¸µí˜• ê´€ë¦¬)")
    
    # MB êµ¬ì„± ê´€ë¦¬ íƒ­ (Controllerì™€ ì™„ì „ ë™ì¼í•œ ê´€ë¦¬ ë°©ì‹)
    mb_tabs = st.tabs([
        "ğŸ·ï¸ MB Type ê´€ë¦¬",
        "ğŸ“ Sub Category ê´€ë¦¬"
    ])
    
    with mb_tabs[0]:
        manage_mb_types_hr_style(config_manager)
    
    with mb_tabs[1]:
        manage_mb_subcategories_hr_style(config_manager)

def manage_mb_types_hr_style(config_manager):
    """MB Type ê´€ë¦¬ - HR System Typeê³¼ ë™ì¼í•œ ë°©ì‹"""
    st.subheader("ğŸ·ï¸ MB Type ê´€ë¦¬")
    st.caption("MBì˜ ê¸°ë³¸ íƒ€ì…ì„ ê´€ë¦¬í•©ë‹ˆë‹¤ (HR System Typeê³¼ ë™ì¼í•œ ë°©ì‹)")
    
    # í˜„ì¬ MB Type ëª©ë¡ í‘œì‹œ (HRê³¼ ë™ì¼í•œ UI)
    mb_types = config_manager.get_hr_components_for_management('mb_type')
    
    if mb_types:
        st.write("**í˜„ì¬ MB Type:**")
        for mb_type in mb_types:
            if mb_type['is_active']:
                col1, col2, col3 = st.columns([6, 1, 1])
                with col1:
                    st.write(f"**{mb_type['component_key']}** - {mb_type['component_name']}")
                    if mb_type['description']:
                        st.caption(mb_type['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_mb_type_{mb_type['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_mb_type_{mb_type['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_mb_type_{mb_type['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(mb_type['component_id']):
                            st.success("MB Typeì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                
                # ìˆ˜ì • í¼ í‘œì‹œ (HRê³¼ ë™ì¼)
                if st.session_state.get(f"editing_mb_type_{mb_type['component_id']}", False):
                    with st.expander("âœï¸ MB Type ìˆ˜ì •", expanded=True):
                        with st.form(f"edit_mb_type_{mb_type['component_id']}"):
                            new_key = st.text_input("í‚¤", value=mb_type['component_key'])
                            new_name = st.text_input("ì´ë¦„", value=mb_type['component_name'])
                            new_description = st.text_input("ì„¤ëª…", value=mb_type['description'] or "")
                            
                            col_submit, col_cancel = st.columns([1, 1])
                            with col_submit:
                                if st.form_submit_button("ğŸ’¾ ì €ì¥"):
                                    if config_manager.update_hr_component(
                                        mb_type['component_id'], component_key=new_key, 
                                        component_name=new_name, description=new_description
                                    ):
                                        st.success("MB Typeì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                        st.session_state[f"editing_mb_type_{mb_type['component_id']}"] = False
                                        st.rerun()
                            
                            with col_cancel:
                                if st.form_submit_button("âŒ ì·¨ì†Œ"):
                                    st.session_state[f"editing_mb_type_{mb_type['component_id']}"] = False
                                    st.rerun()
    else:
        st.info("ë“±ë¡ëœ MB Typeì´ ì—†ìŠµë‹ˆë‹¤.")
    
    # ìƒˆ MB Type ì¶”ê°€ (HRê³¼ ë™ì¼)
    with st.expander("â• ìƒˆ MB Type ì¶”ê°€"):
        with st.form("add_mb_type"):
            new_key = st.text_input("MB Type í‚¤", placeholder="ì˜ˆ: 2P")
            new_name = st.text_input("MB Type ì´ë¦„", placeholder="ì˜ˆ: 2í”Œë ˆì´íŠ¸")
            new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: 2í”Œë ˆì´íŠ¸ ëª°ë“œë² ì´ìŠ¤")
            
            if st.form_submit_button("â• MB Type ì¶”ê°€"):
                if new_key and new_name:
                    success = config_manager.add_hr_component(
                        'mb_type', 'MB', new_key, new_name, None, None, new_description
                    )
                    if success:
                        st.success(f"MB Type '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                        st.rerun()
                    else:
                        st.error("MB Type ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                else:
                    st.warning("MB Type í‚¤ì™€ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")

def manage_mb_subcategories_hr_style(config_manager):
    """MB Sub Category ê´€ë¦¬ - HR Product Typeê³¼ ë™ì¼í•œ ë°©ì‹"""
    st.subheader("ğŸ“ MB Sub Category ê´€ë¦¬")
    st.caption("ì„ íƒëœ MB Typeì˜ ì„œë¸Œ ì¹´í…Œê³ ë¦¬ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤ (HRê³¼ ë™ì¼í•œ ë°©ì‹)")
    
    # MB Type ì„ íƒ (HRê³¼ ë™ì¼)
    mb_types = config_manager.get_mb_types()
    
    if not mb_types:
        st.warning("ë¨¼ì € MB Typeì„ ë“±ë¡í•´ì£¼ì„¸ìš”.")
        return
    
    selected_mb_type = st.selectbox("MB Type ì„ íƒ", [""] + mb_types)
    
    if selected_mb_type:
        # ì„ íƒëœ MB Typeì˜ ì„œë¸Œ ì¹´í…Œê³ ë¦¬ ëª©ë¡ (HRê³¼ ë™ì¼í•œ êµ¬ì¡°)
        sub_categories = config_manager.get_hr_components_for_management('mb_sub_category')
        filtered_subcats = [sc for sc in sub_categories if sc['parent_component'] == selected_mb_type and sc['is_active']]
        
        if filtered_subcats:
            st.write(f"**{selected_mb_type}ì˜ Sub Category:**")
            for sc in filtered_subcats:
                col1, col2, col3 = st.columns([3, 1, 1])
                with col1:
                    st.write(f"â€¢ **{sc['component_key']}** - {sc['component_name']}")
                    if sc['description']:
                        st.caption(sc['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_mb_sc_{sc['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_mb_sc_{sc['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_mb_sc_{sc['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(sc['component_id']):
                            st.success("Sub Categoryê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                
                # ìˆ˜ì • í¼ í‘œì‹œ (HRê³¼ ë™ì¼)
                if st.session_state.get(f"editing_mb_sc_{sc['component_id']}", False):
                    with st.expander("âœï¸ Sub Category ìˆ˜ì •", expanded=True):
                        with st.form(f"edit_mb_sub_category_{sc['component_id']}"):
                            new_key = st.text_input("í‚¤", value=sc['component_key'])
                            new_name = st.text_input("ì´ë¦„", value=sc['component_name'])
                            new_description = st.text_input("ì„¤ëª…", value=sc['description'] or "")
                            
                            col_submit, col_cancel = st.columns([1, 1])
                            with col_submit:
                                if st.form_submit_button("ğŸ’¾ ì €ì¥"):
                                    if config_manager.update_hr_component(
                                        sc['component_id'], component_key=new_key, 
                                        component_name=new_name, description=new_description
                                    ):
                                        st.success("Sub Categoryê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                        st.session_state[f"editing_mb_sc_{sc['component_id']}"] = False
                                        st.rerun()
                            
                            with col_cancel:
                                if st.form_submit_button("âŒ ì·¨ì†Œ"):
                                    st.session_state[f"editing_mb_sc_{sc['component_id']}"] = False
                                    st.rerun()
        else:
            st.info(f"{selected_mb_type}ì— ë“±ë¡ëœ Sub Categoryê°€ ì—†ìŠµë‹ˆë‹¤.")
        
        # ìƒˆ Sub Category ì¶”ê°€ (HRê³¼ ë™ì¼)
        with st.expander(f"â• {selected_mb_type} Sub Category ì¶”ê°€"):
            with st.form(f"add_mb_sub_category_{selected_mb_type}"):
                new_key = st.text_input("Sub Category í‚¤", placeholder="ì˜ˆ: STANDARD")
                new_name = st.text_input("Sub Category ì´ë¦„", placeholder="ì˜ˆ: í‘œì¤€í˜•")
                new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: í‘œì¤€í˜• ëª°ë“œë² ì´ìŠ¤")
                
                if st.form_submit_button("â• Sub Category ì¶”ê°€"):
                    if new_key and new_name:
                        success = config_manager.add_hr_component(
                            'mb_sub_category', 'MB', new_key, new_name, selected_mb_type, None, new_description
                        )
                        if success:
                            st.success(f"Sub Category '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                        else:
                            st.error("Sub Category ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                    else:
                        st.warning("Sub Category í‚¤ì™€ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")

def show_mb_materials_hr_style(config_manager):
    """MB ì¬ì§ˆ ê´€ë¦¬ - HR Sizeì™€ ë™ì¼í•œ ë°©ì‹"""
    st.subheader("ğŸ§± MB ì¬ì§ˆ ê´€ë¦¬")
    st.caption("MB ì¬ì§ˆì„ ê´€ë¦¬í•©ë‹ˆë‹¤ (HR Sizeì™€ ë™ì¼í•œ ë°©ì‹)")
    
    # í˜„ì¬ ì¬ì§ˆ ëª©ë¡ í‘œì‹œ (HRê³¼ ë™ì¼í•œ UI)
    materials = config_manager.get_hr_components_for_management('mb_material')
    
    if materials:
        st.write("**í˜„ì¬ MB ì¬ì§ˆ:**")
        for material in materials:
            if material['is_active']:
                col1, col2, col3 = st.columns([6, 1, 1])
                with col1:
                    st.write(f"**{material['component_key']}** - {material['component_name']}")
                    if material['description']:
                        st.caption(material['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_mb_material_{material['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_mb_material_{material['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_mb_material_{material['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(material['component_id']):
                            st.success("ì¬ì§ˆì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                
                # ìˆ˜ì • í¼ í‘œì‹œ (HRê³¼ ë™ì¼)
                if st.session_state.get(f"editing_mb_material_{material['component_id']}", False):
                    with st.expander("âœï¸ ì¬ì§ˆ ìˆ˜ì •", expanded=True):
                        with st.form(f"edit_mb_material_{material['component_id']}"):
                            new_key = st.text_input("í‚¤", value=material['component_key'])
                            new_name = st.text_input("ì´ë¦„", value=material['component_name'])
                            new_description = st.text_input("ì„¤ëª…", value=material['description'] or "")
                            
                            col_submit, col_cancel = st.columns([1, 1])
                            with col_submit:
                                if st.form_submit_button("ğŸ’¾ ì €ì¥"):
                                    if config_manager.update_hr_component(
                                        material['component_id'], component_key=new_key, 
                                        component_name=new_name, description=new_description
                                    ):
                                        st.success("ì¬ì§ˆì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                        st.session_state[f"editing_mb_material_{material['component_id']}"] = False
                                        st.rerun()
                            
                            with col_cancel:
                                if st.form_submit_button("âŒ ì·¨ì†Œ"):
                                    st.session_state[f"editing_mb_material_{material['component_id']}"] = False
                                    st.rerun()
    else:
        st.info("ë“±ë¡ëœ ì¬ì§ˆì´ ì—†ìŠµë‹ˆë‹¤.")
    
    # ìƒˆ ì¬ì§ˆ ì¶”ê°€ (HRê³¼ ë™ì¼)
    with st.expander("â• ìƒˆ ì¬ì§ˆ ì¶”ê°€"):
        with st.form("add_mb_material"):
            col1, col2 = st.columns(2)
            with col1:
                new_key = st.text_input("ì¬ì§ˆ ì½”ë“œ", placeholder="ì˜ˆ: S45C")
                new_name = st.text_input("ì¬ì§ˆ ì´ë¦„", placeholder="ì˜ˆ: íƒ„ì†Œê°•")
            with col2:
                new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: ì¼ë°˜ êµ¬ì¡°ìš© íƒ„ì†Œê°•")
            
            if st.form_submit_button("â• ì¬ì§ˆ ì¶”ê°€"):
                if new_key and new_name:
                    success = config_manager.add_hr_component(
                        'mb_material', 'MB', new_key, new_name, None, None, new_description
                    )
                    if success:
                        st.success(f"ì¬ì§ˆ '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                        st.rerun()
                    else:
                        st.error("ì¬ì§ˆ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                else:
                    st.warning("ì¬ì§ˆ ì½”ë“œì™€ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")

def show_service_types(config_manager):
    """ì„œë¹„ìŠ¤ íƒ€ì… ê´€ë¦¬ - MBì™€ ë™ì¼í•œ ê³„ì¸µí˜• êµ¬ì¡°"""
    st.subheader("ğŸ› ï¸ ì„œë¹„ìŠ¤ íƒ€ì… ê´€ë¦¬")
    st.caption("ì„œë¹„ìŠ¤ íƒ€ì…ì„ ê³„ì¸µí˜•ìœ¼ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤ (MBì™€ ë™ì¼í•œ ë°©ì‹)")
    
    # íƒ­ìœ¼ë¡œ êµ¬ë¶„
    tab1, tab2, tab3 = st.tabs(["Service Type ê´€ë¦¬", "Sub Category ê´€ë¦¬", "Service ì„¸ë¶€ì‚¬í•­ ê´€ë¦¬"])
    
    with tab1:
        show_service_type_management(config_manager)
    
    with tab2:
        show_service_subcategory_management(config_manager)
    
    with tab3:
        show_service_details_management(config_manager)

def show_service_type_management(config_manager):
    """Service Type ê´€ë¦¬ - MB Typeê³¼ ë™ì¼í•œ ë°©ì‹"""
    st.subheader("ğŸ·ï¸ Service Type ê´€ë¦¬")
    st.caption("Service Typeì„ ê´€ë¦¬í•©ë‹ˆë‹¤ (MB Typeê³¼ ë™ì¼í•œ ë°©ì‹)")
    
    # í˜„ì¬ Service Type ëª©ë¡ í‘œì‹œ
    service_types = config_manager.get_hr_components_for_management('service_type')
    
    if service_types:
        st.write("**í˜„ì¬ Service Type:**")
        for stype in service_types:
            if stype['is_active']:
                col1, col2, col3 = st.columns([6, 1, 1])
                with col1:
                    st.write(f"**{stype['component_key']}** - {stype['component_name']}")
                    if stype['description']:
                        st.caption(stype['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_service_type_{stype['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_service_type_{stype['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_service_type_{stype['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(stype['component_id']):
                            st.success("Service Typeì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                
                # ìˆ˜ì • í¼ í‘œì‹œ
                if st.session_state.get(f"editing_service_type_{stype['component_id']}", False):
                    with st.expander("âœï¸ Service Type ìˆ˜ì •", expanded=True):
                        with st.form(f"edit_service_type_{stype['component_id']}"):
                            new_key = st.text_input("í‚¤", value=stype['component_key'])
                            new_name = st.text_input("ì´ë¦„", value=stype['component_name'])
                            new_description = st.text_input("ì„¤ëª…", value=stype['description'] or "")
                            
                            col_submit, col_cancel = st.columns([1, 1])
                            with col_submit:
                                if st.form_submit_button("ğŸ’¾ ì €ì¥"):
                                    if config_manager.update_hr_component(
                                        stype['component_id'], component_key=new_key, 
                                        component_name=new_name, description=new_description
                                    ):
                                        st.success("Service Typeì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                        st.session_state[f"editing_service_type_{stype['component_id']}"] = False
                                        st.rerun()
                            
                            with col_cancel:
                                if st.form_submit_button("âŒ ì·¨ì†Œ"):
                                    st.session_state[f"editing_service_type_{stype['component_id']}"] = False
                                    st.rerun()
    else:
        st.info("ë“±ë¡ëœ Service Typeì´ ì—†ìŠµë‹ˆë‹¤.")
    
    # ìƒˆ Service Type ì¶”ê°€
    with st.expander("â• ìƒˆ Service Type ì¶”ê°€"):
        with st.form("add_service_type"):
            new_key = st.text_input("Service Type í‚¤", placeholder="ì˜ˆ: TRAINING")
            new_name = st.text_input("Service Type ì´ë¦„", placeholder="ì˜ˆ: êµìœ¡ì„œë¹„ìŠ¤")
            new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: ê³ ê° êµìœ¡ ë° íŠ¸ë ˆì´ë‹ ì„œë¹„ìŠ¤")
            
            if st.form_submit_button("â• Service Type ì¶”ê°€"):
                if new_key and new_name:
                    success = config_manager.add_hr_component(
                        'service_type', 'SERVICE', new_key, new_name, None, None, new_description
                    )
                    if success:
                        st.success(f"Service Type '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                        st.rerun()
                    else:
                        st.error("Service Type ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                else:
                    st.warning("Service Type í‚¤ì™€ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")

def show_service_subcategory_management(config_manager):
    """Service Sub Category ê´€ë¦¬ - MB Sub Categoryì™€ ë™ì¼í•œ ë°©ì‹"""
    st.subheader("ğŸ“‚ Service Sub Category ê´€ë¦¬")
    st.caption("ê° Service Typeì˜ Sub Categoryë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤")
    
    # Service Type ì„ íƒ
    service_types = config_manager.get_hr_components_list('service_type')
    if not service_types:
        st.warning("ë¨¼ì € Service Typeì„ ë“±ë¡í•´ì£¼ì„¸ìš”.")
        return
    
    selected_service_type = st.selectbox(
        "Service Type ì„ íƒ",
        service_types,
        help="Sub Categoryë¥¼ ê´€ë¦¬í•  Service Typeì„ ì„ íƒí•˜ì„¸ìš”"
    )
    
    if selected_service_type:
        # í˜„ì¬ Sub Category ëª©ë¡ í‘œì‹œ
        subcategories = config_manager.get_hr_components_for_management('service_sub_category', selected_service_type)
        
        if subcategories:
            st.write(f"**{selected_service_type}ì˜ Sub Category:**")
            for sc in subcategories:
                if sc['is_active']:
                    col1, col2, col3 = st.columns([6, 1, 1])
                    with col1:
                        st.write(f"**{sc['component_key']}** - {sc['component_name']}")
                        if sc['description']:
                            st.caption(sc['description'])
                    with col2:
                        if st.button("âœï¸", key=f"edit_service_sc_{sc['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                            st.session_state[f"editing_service_sc_{sc['component_id']}"] = True
                            st.rerun()
                    with col3:
                        if st.button("ğŸ—‘ï¸", key=f"delete_service_sc_{sc['component_id']}", help="ì‚­ì œ", use_container_width=True):
                            if config_manager.delete_hr_component(sc['component_id']):
                                st.success("Sub Categoryê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                                st.rerun()
                    
                    # ìˆ˜ì • í¼ í‘œì‹œ
                    if st.session_state.get(f"editing_service_sc_{sc['component_id']}", False):
                        with st.expander("âœï¸ Sub Category ìˆ˜ì •", expanded=True):
                            with st.form(f"edit_service_sc_{sc['component_id']}"):
                                new_key = st.text_input("í‚¤", value=sc['component_key'])
                                new_name = st.text_input("ì´ë¦„", value=sc['component_name'])
                                new_description = st.text_input("ì„¤ëª…", value=sc['description'] or "")
                                
                                col_submit, col_cancel = st.columns([1, 1])
                                with col_submit:
                                    if st.form_submit_button("ğŸ’¾ ì €ì¥"):
                                        if config_manager.update_hr_component(
                                            sc['component_id'], component_key=new_key, 
                                            component_name=new_name, description=new_description
                                        ):
                                            st.success("Sub Categoryê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                            st.session_state[f"editing_service_sc_{sc['component_id']}"] = False
                                            st.rerun()
                                
                                with col_cancel:
                                    if st.form_submit_button("âŒ ì·¨ì†Œ"):
                                        st.session_state[f"editing_service_sc_{sc['component_id']}"] = False
                                        st.rerun()
        else:
            st.info(f"{selected_service_type}ì— ë“±ë¡ëœ Sub Categoryê°€ ì—†ìŠµë‹ˆë‹¤.")
        
        # ìƒˆ Sub Category ì¶”ê°€
        with st.expander(f"â• {selected_service_type} Sub Category ì¶”ê°€"):
            with st.form(f"add_service_sub_category_{selected_service_type}"):
                new_key = st.text_input("Sub Category í‚¤", placeholder="ì˜ˆ: BASIC")
                new_name = st.text_input("Sub Category ì´ë¦„", placeholder="ì˜ˆ: ê¸°ë³¸êµìœ¡")
                new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: ê¸°ë³¸ì ì¸ êµìœ¡ ì„œë¹„ìŠ¤")
                
                if st.form_submit_button("â• Sub Category ì¶”ê°€"):
                    if new_key and new_name:
                        success = config_manager.add_hr_component(
                            'service_sub_category', 'SERVICE', new_key, new_name, selected_service_type, None, new_description
                        )
                        if success:
                            st.success(f"Sub Category '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                        else:
                            st.error("Sub Category ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                    else:
                        st.warning("Sub Category í‚¤ì™€ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")

def show_service_details_management(config_manager):
    """Service ì„¸ë¶€ì‚¬í•­ ê´€ë¦¬ - MB Materialê³¼ ë™ì¼í•œ ë°©ì‹"""
    st.subheader("âš™ï¸ Service ì„¸ë¶€ì‚¬í•­ ê´€ë¦¬")
    st.caption("Service ì„¸ë¶€ì‚¬í•­ì„ ê´€ë¦¬í•©ë‹ˆë‹¤ (MB Materialê³¼ ë™ì¼í•œ ë°©ì‹)")
    
    # í˜„ì¬ ì„¸ë¶€ì‚¬í•­ ëª©ë¡ í‘œì‹œ
    details = config_manager.get_hr_components_for_management('service_detail')
    
    if details:
        st.write("**í˜„ì¬ Service ì„¸ë¶€ì‚¬í•­:**")
        for detail in details:
            if detail['is_active']:
                col1, col2, col3 = st.columns([6, 1, 1])
                with col1:
                    st.write(f"**{detail['component_key']}** - {detail['component_name']}")
                    if detail['description']:
                        st.caption(detail['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_service_detail_{detail['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_service_detail_{detail['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_service_detail_{detail['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(detail['component_id']):
                            st.success("ì„¸ë¶€ì‚¬í•­ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
        
        # ìˆ˜ì • í¼ë“¤ í‘œì‹œ
        for detail in details:
            if detail['is_active'] and st.session_state.get(f"editing_service_detail_{detail['component_id']}", False):
                with st.expander("âœï¸ ì„¸ë¶€ì‚¬í•­ ìˆ˜ì •", expanded=True):
                    with st.form(f"edit_service_detail_{detail['component_id']}"):
                        new_key = st.text_input("í‚¤", value=detail['component_key'])
                        new_name = st.text_input("ì´ë¦„", value=detail['component_name'])
                        new_description = st.text_input("ì„¤ëª…", value=detail['description'] or "")
                        
                        col_submit, col_cancel = st.columns([1, 1])
                        with col_submit:
                            if st.form_submit_button("ğŸ’¾ ì €ì¥"):
                                if config_manager.update_hr_component(
                                    detail['component_id'], component_key=new_key, 
                                    component_name=new_name, description=new_description
                                ):
                                    st.success("ì„¸ë¶€ì‚¬í•­ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                    st.session_state[f"editing_service_detail_{detail['component_id']}"] = False
                                    st.rerun()
                        
                        with col_cancel:
                            if st.form_submit_button("âŒ ì·¨ì†Œ"):
                                st.session_state[f"editing_service_detail_{detail['component_id']}"] = False
                                st.rerun()
    else:
        st.info("ë“±ë¡ëœ Service ì„¸ë¶€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.")
    
    # ìƒˆ ì„¸ë¶€ì‚¬í•­ ì¶”ê°€
    with st.expander("â• Service ì„¸ë¶€ì‚¬í•­ ì¶”ê°€"):
        with st.form("add_service_detail"):
            new_key = st.text_input("ì„¸ë¶€ì‚¬í•­ í‚¤", placeholder="ì˜ˆ: ONSITE")
            new_name = st.text_input("ì„¸ë¶€ì‚¬í•­ ì´ë¦„", placeholder="ì˜ˆ: í˜„ì¥ì„œë¹„ìŠ¤")
            new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: ê³ ê° í˜„ì¥ì—ì„œ ì œê³µí•˜ëŠ” ì„œë¹„ìŠ¤")
            
            if st.form_submit_button("â• ì„¸ë¶€ì‚¬í•­ ì¶”ê°€"):
                if new_key and new_name:
                    success = config_manager.add_hr_component(
                        'service_detail', 'SERVICE', new_key, new_name, None, None, new_description
                    )
                    if success:
                        st.success(f"ì„¸ë¶€ì‚¬í•­ '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                        st.rerun()
                    else:
                        st.error("ì„¸ë¶€ì‚¬í•­ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                else:
                    st.warning("ì„¸ë¶€ì‚¬í•­ í‚¤ì™€ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")

def show_spare_types(config_manager):
    """ì˜ˆë¹„ë¶€í’ˆ íƒ€ì… ê´€ë¦¬ - MBì™€ ë™ì¼í•œ ê³„ì¸µí˜• êµ¬ì¡°"""
    st.subheader("ğŸ”© ì˜ˆë¹„ë¶€í’ˆ íƒ€ì… ê´€ë¦¬")
    st.caption("ì˜ˆë¹„ë¶€í’ˆ íƒ€ì…ì„ ê³„ì¸µí˜•ìœ¼ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤ (MBì™€ ë™ì¼í•œ ë°©ì‹)")
    
    # íƒ­ìœ¼ë¡œ êµ¬ë¶„
    tab1, tab2, tab3 = st.tabs(["Spare Type ê´€ë¦¬", "Sub Category ê´€ë¦¬", "Spare ì„¸ë¶€ì‚¬í•­ ê´€ë¦¬"])
    
    with tab1:
        show_spare_type_management(config_manager)
    
    with tab2:
        show_spare_subcategory_management(config_manager)
    
    with tab3:
        show_spare_details_management(config_manager)

def show_spare_type_management(config_manager):
    """Spare Type ê´€ë¦¬ - MB Typeê³¼ ë™ì¼í•œ ë°©ì‹"""
    st.subheader("ğŸ·ï¸ Spare Type ê´€ë¦¬")
    st.caption("Spare Typeì„ ê´€ë¦¬í•©ë‹ˆë‹¤ (MB Typeê³¼ ë™ì¼í•œ ë°©ì‹)")
    
    # í˜„ì¬ Spare Type ëª©ë¡ í‘œì‹œ
    spare_types = config_manager.get_hr_components_for_management('spare_type')
    
    if spare_types:
        st.write("**í˜„ì¬ Spare Type:**")
        for stype in spare_types:
            if stype['is_active']:
                col1, col2, col3 = st.columns([6, 1, 1])
                with col1:
                    st.write(f"**{stype['component_key']}** - {stype['component_name']}")
                    if stype['description']:
                        st.caption(stype['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_spare_type_{stype['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_spare_type_{stype['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_spare_type_{stype['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(stype['component_id']):
                            st.success("Spare Typeì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                
                # ìˆ˜ì • í¼ í‘œì‹œ
                if st.session_state.get(f"editing_spare_type_{stype['component_id']}", False):
                    with st.expander("âœï¸ Spare Type ìˆ˜ì •", expanded=True):
                        with st.form(f"edit_spare_type_{stype['component_id']}"):
                            new_key = st.text_input("í‚¤", value=stype['component_key'])
                            new_name = st.text_input("ì´ë¦„", value=stype['component_name'])
                            new_description = st.text_input("ì„¤ëª…", value=stype['description'] or "")
                            
                            col_submit, col_cancel = st.columns([1, 1])
                            with col_submit:
                                if st.form_submit_button("ğŸ’¾ ì €ì¥"):
                                    if config_manager.update_hr_component(
                                        stype['component_id'], component_key=new_key, 
                                        component_name=new_name, description=new_description
                                    ):
                                        st.success("Spare Typeì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                        st.session_state[f"editing_spare_type_{stype['component_id']}"] = False
                                        st.rerun()
                            
                            with col_cancel:
                                if st.form_submit_button("âŒ ì·¨ì†Œ"):
                                    st.session_state[f"editing_spare_type_{stype['component_id']}"] = False
                                    st.rerun()
    else:
        st.info("ë“±ë¡ëœ Spare Typeì´ ì—†ìŠµë‹ˆë‹¤.")
    
    # ìƒˆ Spare Type ì¶”ê°€
    with st.expander("â• ìƒˆ Spare Type ì¶”ê°€"):
        with st.form("add_spare_type"):
            new_key = st.text_input("Spare Type í‚¤", placeholder="ì˜ˆ: FILTER")
            new_name = st.text_input("Spare Type ì´ë¦„", placeholder="ì˜ˆ: í•„í„°")
            new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: ê°ì¢… í•„í„° ë¶€í’ˆ")
            
            if st.form_submit_button("â• Spare Type ì¶”ê°€"):
                if new_key and new_name:
                    success = config_manager.add_hr_component(
                        'spare_type', 'SPARE', new_key, new_name, None, None, new_description
                    )
                    if success:
                        st.success(f"Spare Type '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                        st.rerun()
                    else:
                        st.error("Spare Type ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                else:
                    st.warning("Spare Type í‚¤ì™€ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")

def show_spare_subcategory_management(config_manager):
    """Spare Sub Category ê´€ë¦¬ - MB Sub Categoryì™€ ë™ì¼í•œ ë°©ì‹"""
    st.subheader("ğŸ“‚ Spare Sub Category ê´€ë¦¬")
    st.caption("ê° Spare Typeì˜ Sub Categoryë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤")
    
    # Spare Type ì„ íƒ
    spare_types = config_manager.get_hr_components_list('spare_type')
    if not spare_types:
        st.warning("ë¨¼ì € Spare Typeì„ ë“±ë¡í•´ì£¼ì„¸ìš”.")
        return
    
    selected_spare_type = st.selectbox(
        "Spare Type ì„ íƒ",
        spare_types,
        help="Sub Categoryë¥¼ ê´€ë¦¬í•  Spare Typeì„ ì„ íƒí•˜ì„¸ìš”"
    )
    
    if selected_spare_type:
        # í˜„ì¬ Sub Category ëª©ë¡ í‘œì‹œ
        subcategories = config_manager.get_hr_components_for_management('spare_sub_category', selected_spare_type)
        
        if subcategories:
            st.write(f"**{selected_spare_type}ì˜ Sub Category:**")
            for sc in subcategories:
                if sc['is_active']:
                    col1, col2, col3 = st.columns([6, 1, 1])
                    with col1:
                        st.write(f"**{sc['component_key']}** - {sc['component_name']}")
                        if sc['description']:
                            st.caption(sc['description'])
                    with col2:
                        if st.button("âœï¸", key=f"edit_spare_sc_{sc['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                            st.session_state[f"editing_spare_sc_{sc['component_id']}"] = True
                            st.rerun()
                    with col3:
                        if st.button("ğŸ—‘ï¸", key=f"delete_spare_sc_{sc['component_id']}", help="ì‚­ì œ", use_container_width=True):
                            if config_manager.delete_hr_component(sc['component_id']):
                                st.success("Sub Categoryê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                                st.rerun()
                    
                    # ìˆ˜ì • í¼ í‘œì‹œ
                    if st.session_state.get(f"editing_spare_sc_{sc['component_id']}", False):
                        with st.expander("âœï¸ Sub Category ìˆ˜ì •", expanded=True):
                            with st.form(f"edit_spare_sc_{sc['component_id']}"):
                                new_key = st.text_input("í‚¤", value=sc['component_key'])
                                new_name = st.text_input("ì´ë¦„", value=sc['component_name'])
                                new_description = st.text_input("ì„¤ëª…", value=sc['description'] or "")
                                
                                col_submit, col_cancel = st.columns([1, 1])
                                with col_submit:
                                    if st.form_submit_button("ğŸ’¾ ì €ì¥"):
                                        if config_manager.update_hr_component(
                                            sc['component_id'], component_key=new_key, 
                                            component_name=new_name, description=new_description
                                        ):
                                            st.success("Sub Categoryê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                            st.session_state[f"editing_spare_sc_{sc['component_id']}"] = False
                                            st.rerun()
                                
                                with col_cancel:
                                    if st.form_submit_button("âŒ ì·¨ì†Œ"):
                                        st.session_state[f"editing_spare_sc_{sc['component_id']}"] = False
                                        st.rerun()
        else:
            st.info(f"{selected_spare_type}ì— ë“±ë¡ëœ Sub Categoryê°€ ì—†ìŠµë‹ˆë‹¤.")
        
        # ìƒˆ Sub Category ì¶”ê°€
        with st.expander(f"â• {selected_spare_type} Sub Category ì¶”ê°€"):
            with st.form(f"add_spare_sub_category_{selected_spare_type}"):
                new_key = st.text_input("Sub Category í‚¤", placeholder="ì˜ˆ: REGULAR")
                new_name = st.text_input("Sub Category ì´ë¦„", placeholder="ì˜ˆ: ì¼ë°˜í˜•")
                new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: ì¼ë°˜ì ì¸ í˜•íƒœì˜ ë¶€í’ˆ")
                
                if st.form_submit_button("â• Sub Category ì¶”ê°€"):
                    if new_key and new_name:
                        success = config_manager.add_hr_component(
                            'spare_sub_category', 'SPARE', new_key, new_name, selected_spare_type, None, new_description
                        )
                        if success:
                            st.success(f"Sub Category '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
                        else:
                            st.error("Sub Category ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                    else:
                        st.warning("Sub Category í‚¤ì™€ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")

def show_spare_details_management(config_manager):
    """Spare ì„¸ë¶€ì‚¬í•­ ê´€ë¦¬ - MB Materialê³¼ ë™ì¼í•œ ë°©ì‹"""
    st.subheader("âš™ï¸ Spare ì„¸ë¶€ì‚¬í•­ ê´€ë¦¬")
    st.caption("Spare ì„¸ë¶€ì‚¬í•­ì„ ê´€ë¦¬í•©ë‹ˆë‹¤ (MB Materialê³¼ ë™ì¼í•œ ë°©ì‹)")
    
    # í˜„ì¬ ì„¸ë¶€ì‚¬í•­ ëª©ë¡ í‘œì‹œ
    details = config_manager.get_hr_components_for_management('spare_detail')
    
    if details:
        st.write("**í˜„ì¬ Spare ì„¸ë¶€ì‚¬í•­:**")
        for detail in details:
            if detail['is_active']:
                col1, col2, col3 = st.columns([6, 1, 1])
                with col1:
                    st.write(f"**{detail['component_key']}** - {detail['component_name']}")
                    if detail['description']:
                        st.caption(detail['description'])
                with col2:
                    if st.button("âœï¸", key=f"edit_spare_detail_{detail['component_id']}", help="ìˆ˜ì •", use_container_width=True):
                        st.session_state[f"editing_spare_detail_{detail['component_id']}"] = True
                        st.rerun()
                with col3:
                    if st.button("ğŸ—‘ï¸", key=f"delete_spare_detail_{detail['component_id']}", help="ì‚­ì œ", use_container_width=True):
                        if config_manager.delete_hr_component(detail['component_id']):
                            st.success("ì„¸ë¶€ì‚¬í•­ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!")
                            st.rerun()
        
        # ìˆ˜ì • í¼ë“¤ í‘œì‹œ
        for detail in details:
            if detail['is_active'] and st.session_state.get(f"editing_spare_detail_{detail['component_id']}", False):
                with st.expander("âœï¸ ì„¸ë¶€ì‚¬í•­ ìˆ˜ì •", expanded=True):
                    with st.form(f"edit_spare_detail_{detail['component_id']}"):
                        new_key = st.text_input("í‚¤", value=detail['component_key'])
                        new_name = st.text_input("ì´ë¦„", value=detail['component_name'])
                        new_description = st.text_input("ì„¤ëª…", value=detail['description'] or "")
                        
                        col_submit, col_cancel = st.columns([1, 1])
                        with col_submit:
                            if st.form_submit_button("ğŸ’¾ ì €ì¥"):
                                if config_manager.update_hr_component(
                                    detail['component_id'], component_key=new_key, 
                                    component_name=new_name, description=new_description
                                ):
                                    st.success("ì„¸ë¶€ì‚¬í•­ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!")
                                    st.session_state[f"editing_spare_detail_{detail['component_id']}"] = False
                                    st.rerun()
                        
                        with col_cancel:
                            if st.form_submit_button("âŒ ì·¨ì†Œ"):
                                st.session_state[f"editing_spare_detail_{detail['component_id']}"] = False
                                st.rerun()
    else:
        st.info("ë“±ë¡ëœ Spare ì„¸ë¶€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.")
    
    # ìƒˆ ì„¸ë¶€ì‚¬í•­ ì¶”ê°€
    with st.expander("â• Spare ì„¸ë¶€ì‚¬í•­ ì¶”ê°€"):
        with st.form("add_spare_detail"):
            new_key = st.text_input("ì„¸ë¶€ì‚¬í•­ í‚¤", placeholder="ì˜ˆ: OEM")
            new_name = st.text_input("ì„¸ë¶€ì‚¬í•­ ì´ë¦„", placeholder="ì˜ˆ: ì •í’ˆë¶€í’ˆ")
            new_description = st.text_input("ì„¤ëª…", placeholder="ì˜ˆ: ì œì¡°ì‚¬ ì •í’ˆ ë¶€í’ˆ")
            
            if st.form_submit_button("â• ì„¸ë¶€ì‚¬í•­ ì¶”ê°€"):
                if new_key and new_name:
                    success = config_manager.add_hr_component(
                        'spare_detail', 'SPARE', new_key, new_name, None, None, new_description
                    )
                    if success:
                        st.success(f"ì„¸ë¶€ì‚¬í•­ '{new_key}'ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                        st.rerun()
                    else:
                        st.error("ì„¸ë¶€ì‚¬í•­ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
                else:
                    st.warning("ì„¸ë¶€ì‚¬í•­ í‚¤ì™€ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.")

def show_company_info_settings():
    """íšŒì‚¬ ì •ë³´ ì„¤ì • íƒ­"""
    st.subheader("ğŸ¢ íšŒì‚¬ ì •ë³´ ì„¤ì •")
    st.caption("íšŒì‚¬ ê¸°ë³¸ ì •ë³´ì™€ ì—°ë½ì²˜ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤")
    
    # íšŒì‚¬ ê¸°ë³¸ ì •ë³´
    with st.expander("ğŸ“‹ íšŒì‚¬ ê¸°ë³¸ ì •ë³´", expanded=True):
        col1, col2 = st.columns(2)
        with col1:
            company_name = st.text_input("íšŒì‚¬ëª…", value="YUMOLD Co., Ltd.")
            company_name_en = st.text_input("ì˜ë¬¸ íšŒì‚¬ëª…", value="YUMOLD Co., Ltd.")
            business_number = st.text_input("ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸", value="123-45-67890")
            ceo_name = st.text_input("ëŒ€í‘œìëª…", value="ëŒ€í‘œì´ì‚¬")
        with col2:
            address = st.text_area("ì£¼ì†Œ", value="ë² íŠ¸ë‚¨ í•˜ë…¸ì´ì‹œ")
            phone = st.text_input("ì „í™”ë²ˆí˜¸", value="+84-xxx-xxxx")
            email = st.text_input("ì´ë©”ì¼", value="info@yumold.com")
            website = st.text_input("ì›¹ì‚¬ì´íŠ¸", value="www.yumold.com")
        
        if st.button("ğŸ’¾ íšŒì‚¬ ì •ë³´ ì €ì¥"):
            st.success("íšŒì‚¬ ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!")
    
    # ê¸°ë³¸ í†µí™” ë° ì–¸ì–´ ì„¤ì •
    with st.expander("ğŸŒ ê¸°ë³¸ ì„¤ì •"):
        col1, col2 = st.columns(2)
        with col1:
            default_currency = st.selectbox("ê¸°ë³¸ í†µí™”", ["VND", "USD", "KRW"], index=0)
            default_language = st.selectbox("ê¸°ë³¸ ì–¸ì–´", ["í•œêµ­ì–´", "English", "Tiáº¿ng Viá»‡t"], index=0)
        with col2:
            timezone = st.selectbox("ì‹œê°„ëŒ€", ["Asia/Ho_Chi_Minh", "Asia/Seoul", "UTC"], index=0)
            date_format = st.selectbox("ë‚ ì§œ í˜•ì‹", ["YYYY-MM-DD", "DD/MM/YYYY", "MM/DD/YYYY"], index=0)
        
        if st.button("ğŸ”„ ê¸°ë³¸ ì„¤ì • ì €ì¥"):
            st.success("ê¸°ë³¸ ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!")

def show_system_options():
    """ì‹œìŠ¤í…œ ì˜µì…˜ íƒ­"""
    st.subheader("ğŸ”§ ì‹œìŠ¤í…œ ì˜µì…˜")
    st.caption("ì‹œìŠ¤í…œ ì „ë°˜ì˜ ì„¤ì •ì„ ê´€ë¦¬í•©ë‹ˆë‹¤")
    
    # ì‹œìŠ¤í…œ ë³´ì•ˆ ì„¤ì •
    with st.expander("ğŸ” ë³´ì•ˆ ì„¤ì •"):
        col1, col2 = st.columns(2)
        with col1:
            password_policy = st.selectbox("ë¹„ë°€ë²ˆí˜¸ ì •ì±…", ["ê¸°ë³¸", "ê°•í™”", "ë§¤ìš°ê°•í™”"], index=0)
            session_timeout = st.number_input("ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ(ë¶„)", min_value=10, max_value=480, value=60)
        with col2:
            login_attempts = st.number_input("ìµœëŒ€ ë¡œê·¸ì¸ ì‹œë„ íšŸìˆ˜", min_value=3, max_value=10, value=5)
            enable_2fa = st.checkbox("ì´ì¤‘ ì¸ì¦ í™œì„±í™”", value=False)
        
        if st.button("ğŸ›¡ï¸ ë³´ì•ˆ ì„¤ì • ì €ì¥"):
            st.success("ë³´ì•ˆ ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!")
    
    # ì„±ëŠ¥ ì„¤ì •
    with st.expander("âš¡ ì„±ëŠ¥ ì„¤ì •"):
        col1, col2 = st.columns(2)
        with col1:
            page_size = st.number_input("í˜ì´ì§€ë‹¹ í•­ëª© ìˆ˜", min_value=10, max_value=100, value=20)
            cache_duration = st.number_input("ìºì‹œ ìœ ì§€ ì‹œê°„(ì´ˆ)", min_value=60, max_value=3600, value=300)
        with col2:
            enable_logging = st.checkbox("ì‹œìŠ¤í…œ ë¡œê¹… í™œì„±í™”", value=True)
            log_level = st.selectbox("ë¡œê·¸ ë ˆë²¨", ["ERROR", "WARNING", "INFO", "DEBUG"], index=2)
        
        if st.button("ğŸš€ ì„±ëŠ¥ ì„¤ì • ì €ì¥"):
            st.success("ì„±ëŠ¥ ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!")